<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>【转载】SQL 练习 | 罗泽勋</title>
<meta name="keywords" content="">
<meta name="description" content="SQL 练习 SQL 练习 595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats 595. Big Countries https://leetcode.com/problems/big-countries/description/">
<meta name="author" content="糸色先生">
<link rel="canonical" href="/collection/2021-12-22-sqldemo/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css" integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/collection/2021-12-22-sqldemo/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KDTTBGMLCQ"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-KDTTBGMLCQ', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="【转载】SQL 练习" />
<meta property="og:description" content="SQL 练习 SQL 练习 595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats 595. Big Countries https://leetcode.com/problems/big-countries/description/" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/collection/2021-12-22-sqldemo/" /><meta property="article:section" content="collection" />
<meta property="article:published_time" content="2021-12-22T23:32:38&#43;08:00" />
<meta property="article:modified_time" content="2021-12-22T23:32:38&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="【转载】SQL 练习"/>
<meta name="twitter:description" content="SQL 练习 SQL 练习 595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats 595. Big Countries https://leetcode.com/problems/big-countries/description/"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "收录文章",
      "item": "/collection/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "【转载】SQL 练习",
      "item": "/collection/2021-12-22-sqldemo/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【转载】SQL 练习",
  "name": "【转载】SQL 练习",
  "description": "SQL 练习 SQL 练习 595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats 595. Big Countries https://leetcode.com/problems/big-countries/description/",
  "keywords": [
    
  ],
  "articleBody": "SQL 练习  SQL 练习  595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats    595. Big Countries https://leetcode.com/problems/big-countries/description/\nDescription +-----------------+------------+------------+--------------+---------------+ | name | continent | area | population | gdp | +-----------------+------------+------------+--------------+---------------+ | Afghanistan | Asia | 652230 | 25500100 | 20343000 | | Albania | Europe | 28748 | 2831741 | 12960000 | | Algeria | Africa | 2381741 | 37100000 | 188681000 | | Andorra | Europe | 468 | 78115 | 3712000 | | Angola | Africa | 1246700 | 20609294 | 100990000 | +-----------------+------------+------------+--------------+---------------+ 查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。\n+--------------+-------------+--------------+ | name | population | area | +--------------+-------------+--------------+ | Afghanistan | 25500100 | 652230 | | Algeria | 37100000 | 2381741 | +--------------+-------------+--------------+ Solution SELECTname,population,areaFROMWorldWHEREarea3000000ORpopulation25000000;SQL Schema SQL Schema 用于在本地环境下创建表结构并导入数据，从而方便在本地环境调试。\nDROPTABLEIFEXISTSWorld;CREATETABLEWorld(NAMEVARCHAR(255),continentVARCHAR(255),areaINT,populationINT,gdpINT);INSERTINTOWorld(NAME,continent,area,population,gdp)VALUES('Afghanistan','Asia','652230','25500100','203430000'),('Albania','Europe','28748','2831741','129600000'),('Algeria','Africa','2381741','37100000','1886810000'),('Andorra','Europe','468','78115','37120000'),('Angola','Africa','1246700','20609294','1009900000');627. Swap Salary https://leetcode.com/problems/swap-salary/description/\nDescription | id | name | sex | salary | |----|------|-----|--------| | 1 | A | m | 2500 | | 2 | B | f | 1500 | | 3 | C | m | 5500 | | 4 | D | f | 500 | 只用一个 SQL 查询，将 sex 字段反转。\n| id | name | sex | salary | |----|------|-----|--------| | 1 | A | f | 2500 | | 2 | B | m | 1500 | | 3 | C | f | 5500 | | 4 | D | m | 500 | Solution 两个相等的数异或的结果为 0，而 0 与任何一个数异或的结果为这个数。\nsex 字段只有两个取值：‘f’ 和 ’m’，并且有以下规律：\n'f' ^ ('m' ^ 'f') = 'm' ^ ('f' ^ 'f') = 'm' 'm' ^ ('m' ^ 'f') = 'f' ^ ('m' ^ 'm') = 'f' 因此将 sex 字段和 ’m’ ^ ‘f’ 进行异或操作，最后就能反转 sex 字段。\nUPDATEsalarySETsex=CHAR(ASCII(sex)^ASCII('m')^ASCII('f'));SQL Schema DROPTABLEIFEXISTSsalary;CREATETABLEsalary(idINT,NAMEVARCHAR(100),sexCHAR(1),salaryINT);INSERTINTOsalary(id,NAME,sex,salary)VALUES('1','A','m','2500'),('2','B','f','1500'),('3','C','m','5500'),('4','D','f','500');620. Not Boring Movies https://leetcode.com/problems/not-boring-movies/description/\nDescription +---------+-----------+--------------+-----------+ | id | movie | description | rating | +---------+-----------+--------------+-----------+ | 1 | War | great 3D | 8.9 | | 2 | Science | fiction | 8.5 | | 3 | irish | boring | 6.2 | | 4 | Ice song | Fantacy | 8.6 | | 5 | House card| Interesting| 9.1 | +---------+-----------+--------------+-----------+ 查找 id 为奇数，并且 description 不是 boring 的电影，按 rating 降序。\n+---------+-----------+--------------+-----------+ | id | movie | description | rating | +---------+-----------+--------------+-----------+ | 5 | House card| Interesting| 9.1 | | 1 | War | great 3D | 8.9 | +---------+-----------+--------------+-----------+ Solution SELECT*FROMcinemaWHEREid%2=1ANDdescription!='boring'ORDERBYratingDESC;SQL Schema DROPTABLEIFEXISTScinema;CREATETABLEcinema(idINT,movieVARCHAR(255),descriptionVARCHAR(255),ratingFLOAT(2,1));INSERTINTOcinema(id,movie,description,rating)VALUES(1,'War','great 3D',8.9),(2,'Science','fiction',8.5),(3,'irish','boring',6.2),(4,'Ice song','Fantacy',8.6),(5,'House card','Interesting',9.1);596. Classes More Than 5 Students https://leetcode.com/problems/classes-more-than-5-students/description/\nDescription +---------+------------+ | student | class | +---------+------------+ | A | Math | | B | English | | C | Math | | D | Biology | | E | Math | | F | Computer | | G | Math | | H | Math | | I | Math | +---------+------------+ 查找有五名及以上 student 的 class。\n+---------+ | class | +---------+ | Math | +---------+ Solution 对 class 列进行分组之后，再使用 count 汇总函数统计每个分组的记录个数，之后使用 HAVING 进行筛选。HAVING 针对分组进行筛选，而 WHERE 针对每个记录（行）进行筛选。\nSELECTclassFROMcoursesGROUPBYclassHAVINGcount(DISTINCTstudent)=5;SQL Schema DROPTABLEIFEXISTScourses;CREATETABLEcourses(studentVARCHAR(255),classVARCHAR(255));INSERTINTOcourses(student,class)VALUES('A','Math'),('B','English'),('C','Math'),('D','Biology'),('E','Math'),('F','Computer'),('G','Math'),('H','Math'),('I','Math');182. Duplicate Emails https://leetcode.com/problems/duplicate-emails/description/\nDescription 邮件地址表：\n+----+---------+ | Id | Email | +----+---------+ | 1 | a@b.com | | 2 | c@d.com | | 3 | a@b.com | +----+---------+ 查找重复的邮件地址：\n+---------+ | Email | +---------+ | a@b.com | +---------+ Solution 对 Email 进行分组，如果并使用 COUNT 进行计数统计，结果大于等于 2 的表示 Email 重复。\nSELECTEmailFROMPersonGROUPBYEmailHAVINGCOUNT(*)=2;SQL Schema DROPTABLEIFEXISTSPerson;CREATETABLEPerson(IdINT,EmailVARCHAR(255));INSERTINTOPerson(Id,Email)VALUES(1,'a@b.com'),(2,'c@d.com'),(3,'a@b.com');196. Delete Duplicate Emails https://leetcode.com/problems/delete-duplicate-emails/description/\nDescription 邮件地址表：\n+----+---------+ | Id | Email | +----+---------+ | 1 | john@example.com | | 2 | bob@example.com | | 3 | john@example.com | +----+---------+ 删除重复的邮件地址：\n+----+------------------+ | Id | Email | +----+------------------+ | 1 | john@example.com | | 2 | bob@example.com | +----+------------------+ Solution 只保留相同 Email 中 Id 最小的那一个，然后删除其它的。\n连接查询：\nDELETEp1FROMPersonp1,Personp2WHEREp1.Email=p2.EmailANDp1.Idp2.Id子查询：\nDELETEFROMPersonWHEREidNOTIN(SELECTidFROM(SELECTmin(id)ASidFROMPersonGROUPBYemail)ASm);应该注意的是上述解法额外嵌套了一个 SELECT 语句，如果不这么做，会出现错误：You can’t specify target table ‘Person’ for update in FROM clause。以下演示了这种错误解法。\nDELETEFROMPersonWHEREidNOTIN(SELECTmin(id)ASidFROMPersonGROUPBYemail);参考：pMySQL Error 1093 - Can’t specify target table for update in FROM clause\nSQL Schema 与 182 相同。\n175. Combine Two Tables https://leetcode.com/problems/combine-two-tables/description/\nDescription Person 表：\n+-------------+---------+ | Column Name | Type | +-------------+---------+ | PersonId | int | | FirstName | varchar | | LastName | varchar | +-------------+---------+ PersonId is the primary key column for this table. Address 表：\n+-------------+---------+ | Column Name | Type | +-------------+---------+ | AddressId | int | | PersonId | int | | City | varchar | | State | varchar | +-------------+---------+ AddressId is the primary key column for this table. 查找 FirstName, LastName, City, State 数据，而不管一个用户有没有填地址信息。\nSolution 涉及到 Person 和 Address 两个表，在对这两个表执行连接操作时，因为要保留 Person 表中的信息，即使在 Address 表中没有关联的信息也要保留。此时可以用左外连接，将 Person 表放在 LEFT JOIN 的左边。\nSELECTFirstName,LastName,City,StateFROMPersonPLEFTJOINAddressAONP.PersonId=A.PersonId;SQL Schema DROPTABLEIFEXISTSPerson;CREATETABLEPerson(PersonIdINT,FirstNameVARCHAR(255),LastNameVARCHAR(255));DROPTABLEIFEXISTSAddress;CREATETABLEAddress(AddressIdINT,PersonIdINT,CityVARCHAR(255),StateVARCHAR(255));INSERTINTOPerson(PersonId,LastName,FirstName)VALUES(1,'Wang','Allen');INSERTINTOAddress(AddressId,PersonId,City,State)VALUES(1,2,'New York City','New York');181. Employees Earning More Than Their Managers https://leetcode.com/problems/employees-earning-more-than-their-managers/description/\nDescription Employee 表：\n+----+-------+--------+-----------+ | Id | Name | Salary | ManagerId | +----+-------+--------+-----------+ | 1 | Joe | 70000 | 3 | | 2 | Henry | 80000 | 4 | | 3 | Sam | 60000 | NULL | | 4 | Max | 90000 | NULL | +----+-------+--------+-----------+ 查找薪资大于其经理薪资的员工信息。\nSolution SELECTE1.NAMEASEmployeeFROMEmployeeE1INNERJOINEmployeeE2ONE1.ManagerId=E2.IdANDE1.SalaryE2.Salary;SQL Schema DROPTABLEIFEXISTSEmployee;CREATETABLEEmployee(IdINT,NAMEVARCHAR(255),SalaryINT,ManagerIdINT);INSERTINTOEmployee(Id,NAME,Salary,ManagerId)VALUES(1,'Joe',70000,3),(2,'Henry',80000,4),(3,'Sam',60000,NULL),(4,'Max',90000,NULL);183. Customers Who Never Order https://leetcode.com/problems/customers-who-never-order/description/\nDescription Customers 表：\n+----+-------+ | Id | Name | +----+-------+ | 1 | Joe | | 2 | Henry | | 3 | Sam | | 4 | Max | +----+-------+ Orders 表：\n+----+------------+ | Id | CustomerId | +----+------------+ | 1 | 3 | | 2 | 1 | +----+------------+ 查找没有订单的顾客信息：\n+-----------+ | Customers | +-----------+ | Henry | | Max | +-----------+ Solution 左外链接\nSELECTC.NameASCustomersFROMCustomersCLEFTJOINOrdersOONC.Id=O.CustomerIdWHEREO.CustomerIdISNULL;子查询\nSELECTNameASCustomersFROMCustomersWHEREIdNOTIN(SELECTCustomerIdFROMOrders);SQL Schema DROPTABLEIFEXISTSCustomers;CREATETABLECustomers(IdINT,NAMEVARCHAR(255));DROPTABLEIFEXISTSOrders;CREATETABLEOrders(IdINT,CustomerIdINT);INSERTINTOCustomers(Id,NAME)VALUES(1,'Joe'),(2,'Henry'),(3,'Sam'),(4,'Max');INSERTINTOOrders(Id,CustomerId)VALUES(1,3),(2,1);184. Department Highest Salary https://leetcode.com/problems/department-highest-salary/description/\nDescription Employee 表：\n+----+-------+--------+--------------+ | Id | Name | Salary | DepartmentId | +----+-------+--------+--------------+ | 1 | Joe | 70000 | 1 | | 2 | Henry | 80000 | 2 | | 3 | Sam | 60000 | 2 | | 4 | Max | 90000 | 1 | +----+-------+--------+--------------+ Department 表：\n+----+----------+ | Id | Name | +----+----------+ | 1 | IT | | 2 | Sales | +----+----------+ 查找一个 Department 中收入最高者的信息：\n+------------+----------+--------+ | Department | Employee | Salary | +------------+----------+--------+ | IT | Max | 90000 | | Sales | Henry | 80000 | +------------+----------+--------+ Solution 创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。\n之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。\nSELECTD.NAMEDepartment,E.NAMEEmployee,E.SalaryFROMEmployeeE,DepartmentD,(SELECTDepartmentId,MAX(Salary)SalaryFROMEmployeeGROUPBYDepartmentId)MWHEREE.DepartmentId=D.IdANDE.DepartmentId=M.DepartmentIdANDE.Salary=M.Salary;SQL Schema DROPTABLEIFEXISTSEmployee;CREATETABLEEmployee(IdINT,NAMEVARCHAR(255),SalaryINT,DepartmentIdINT);DROPTABLEIFEXISTSDepartment;CREATETABLEDepartment(IdINT,NAMEVARCHAR(255));INSERTINTOEmployee(Id,NAME,Salary,DepartmentId)VALUES(1,'Joe',70000,1),(2,'Henry',80000,2),(3,'Sam',60000,2),(4,'Max',90000,1);INSERTINTODepartment(Id,NAME)VALUES(1,'IT'),(2,'Sales');176. Second Highest Salary https://leetcode.com/problems/second-highest-salary/description/\nDescription +----+--------+ | Id | Salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ 查找工资第二高的员工。\n+---------------------+ | SecondHighestSalary | +---------------------+ | 200 | +---------------------+ 没有找到返回 null 而不是不返回数据。\nSolution 为了在没有查找到数据时返回 null，需要在查询结果外面再套一层 SELECT。\nSELECT(SELECTDISTINCTSalaryFROMEmployeeORDERBYSalaryDESCLIMIT1,1)SecondHighestSalary;SQL Schema DROPTABLEIFEXISTSEmployee;CREATETABLEEmployee(IdINT,SalaryINT);INSERTINTOEmployee(Id,Salary)VALUES(1,100),(2,200),(3,300);177. Nth Highest Salary Description 查找工资第 N 高的员工。\nSolution CREATEFUNCTIONgetNthHighestSalary(NINT)RETURNSINTBEGINSETN=N-1;RETURN(SELECT(SELECTDISTINCTSalaryFROMEmployeeORDERBYSalaryDESCLIMITN,1));ENDSQL Schema 同 176。\n178. Rank Scores https://leetcode.com/problems/rank-scores/description/\nDescription 得分表：\n+----+-------+ | Id | Score | +----+-------+ | 1 | 3.50 | | 2 | 3.65 | | 3 | 4.00 | | 4 | 3.85 | | 5 | 4.00 | | 6 | 3.65 | +----+-------+ 将得分排序，并统计排名。\n+-------+------+ | Score | Rank | +-------+------+ | 4.00 | 1 | | 4.00 | 1 | | 3.85 | 2 | | 3.65 | 3 | | 3.65 | 3 | | 3.50 | 4 | +-------+------+ Solution 要统计某个 score 的排名，只要统计大于等于该 score 的 score 数量。\n   Id score 大于等于该 score 的 score 数量 排名     1 4.1 3 3   2 4.2 2 2   3 4.3 1 1    使用连接操作找到某个 score 对应的大于等于其值的记录：\nSELECT*FROMScoresS1INNERJOINScoresS2ONS1.scoreS2.scoreORDERBYS1.scoreDESC,S1.Id;   S1.Id S1.score S2.Id S2.score     3 4.3 3 4.3   2 4.2 2 4.2   2 4.2 3 4.3   1 4.1 1 4.1   1 4.1 2 4.2   1 4.1 3 4.3    可以看到每个 S1.score 都有对应好几条记录，我们再进行分组，并统计每个分组的数量作为 ‘Rank’\nSELECTS1.score'Score',COUNT(*)'Rank'FROMScoresS1INNERJOINScoresS2ONS1.scoreS2.scoreGROUPBYS1.id,S1.scoreORDERBYS1.scoreDESC,S1.Id;   score Rank     4.3 1   4.2 2   4.1 3    上面的解法看似没问题，但是对于以下数据，它却得到了错误的结果：\n   Id score     1 4.1   2 4.2   3 4.2       score Rank     4.2 2   4.2 2   4.1 3    而我们希望的结果为：\n   score Rank     4.2 1   4.2 1   4.1 2    连接情况如下：\n   S1.Id S1.score S2.Id S2.score     2 4.2 3 4.2   2 4.2 2 4.2   3 4.2 3 4.2   3 4.2 2 4.1   1 4.1 3 4.2   1 4.1 2 4.2   1 4.1 1 4.1    我们想要的结果是，把分数相同的放在同一个排名，并且相同分数只占一个位置，例如上面的分数，Id=2 和 Id=3 的记录都有相同的分数，并且最高，他们并列第一。而 Id=1 的记录应该排第二名，而不是第三名。所以在进行 COUNT 计数统计时，我们需要使用 COUNT( DISTINCT S2.score ) 从而只统计一次相同的分数。\nSELECTS1.score'Score',COUNT(DISTINCTS2.score)'Rank'FROMScoresS1INNERJOINScoresS2ONS1.scoreS2.scoreGROUPBYS1.id,S1.scoreORDERBYS1.scoreDESC;SQL Schema DROPTABLEIFEXISTSScores;CREATETABLEScores(IdINT,ScoreDECIMAL(3,2));INSERTINTOScores(Id,Score)VALUES(1,4.1),(2,4.1),(3,4.2),(4,4.2),(5,4.3),(6,4.3);180. Consecutive Numbers https://leetcode.com/problems/consecutive-numbers/description/\nDescription 数字表：\n+----+-----+ | Id | Num | +----+-----+ | 1 | 1 | | 2 | 1 | | 3 | 1 | | 4 | 2 | | 5 | 1 | | 6 | 2 | | 7 | 2 | +----+-----+ 查找连续出现三次的数字。\n+-----------------+ | ConsecutiveNums | +-----------------+ | 1 | +-----------------+ Solution SELECTDISTINCTL1.numConsecutiveNumsFROMLogsL1,LogsL2,LogsL3WHEREL1.id=l2.id-1ANDL2.id=L3.id-1ANDL1.num=L2.numANDl2.num=l3.num;SQL Schema DROPTABLEIFEXISTSLOGS;CREATETABLELOGS(IdINT,NumINT);INSERTINTOLOGS(Id,Num)VALUES(1,1),(2,1),(3,1),(4,2),(5,1),(6,2),(7,2);626. Exchange Seats https://leetcode.com/problems/exchange-seats/description/\nDescription seat 表存储着座位对应的学生。\n+---------+---------+ | id | student | +---------+---------+ | 1 | Abbot | | 2 | Doris | | 3 | Emerson | | 4 | Green | | 5 | Jeames | +---------+---------+ 要求交换相邻座位的两个学生，如果最后一个座位是奇数，那么不交换这个座位上的学生。\n+---------+---------+ | id | student | +---------+---------+ | 1 | Doris | | 2 | Abbot | | 3 | Green | | 4 | Emerson | | 5 | Jeames | +---------+---------+ Solution 使用多个 union。\n##处理偶数id，让id减1##例如2,4,6,...变成1,3,5,...SELECTs1.id-1ASid,s1.studentFROMseats1WHEREs1.idMOD2=0UNION##处理奇数id，让id加1。但是如果最大的id为奇数，则不做处理##例如1,3,5,...变成2,4,6,...SELECTs2.id+1ASid,s2.studentFROMseats2WHEREs2.idMOD2=1ANDs2.id!=(SELECTmax(s3.id)FROMseats3)UNION##如果最大的id为奇数，单独取出这个数SELECTs4.idASid,s4.studentFROMseats4WHEREs4.idMOD2=1ANDs4.id=(SELECTmax(s5.id)FROMseats5)ORDERBYid;SQL Schema DROPTABLEIFEXISTSseat;CREATETABLEseat(idINT,studentVARCHAR(255));INSERTINTOseat(id,student)VALUES('1','Abbot'),('2','Doris'),('3','Emerson'),('4','Green'),('5','Jeames');",
  "wordCount" : "3106",
  "inLanguage": "en",
  "datePublished": "2021-12-22T23:32:38+08:00",
  "dateModified": "2021-12-22T23:32:38+08:00",
  "author":{
    "@type": "Person",
    "name": "糸色先生"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/collection/2021-12-22-sqldemo/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "罗泽勋",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="罗泽勋 (Alt + H)">罗泽勋</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/cn/" title="中文"
                            aria-label="中文">Cn</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Program">
                    <span>Program</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      【转载】SQL 练习
    </h1>
    <div class="post-meta"><span title='2021-12-22 23:32:38 +0800 CST'>December 22, 2021</span>&nbsp;·&nbsp;糸色先生

</div>
  </header> 
  <div class="post-content"><h1 id="sql-练习">SQL 练习<a hidden class="anchor" aria-hidden="true" href="#sql-练习">#</a></h1>
<!-- GFM-TOC -->
<ul>
<li><a href="#sql-%E7%BB%83%E4%B9%A0">SQL 练习</a>
<ul>
<li><a href="#595-big-countries">595. Big Countries</a></li>
<li><a href="#627-swap-salary">627. Swap Salary</a></li>
<li><a href="#620-not-boring-movies">620. Not Boring Movies</a></li>
<li><a href="#596-classes-more-than-5-students">596. Classes More Than 5 Students</a></li>
<li><a href="#182-duplicate-emails">182. Duplicate Emails</a></li>
<li><a href="#196-delete-duplicate-emails">196. Delete Duplicate Emails</a></li>
<li><a href="#175-combine-two-tables">175. Combine Two Tables</a></li>
<li><a href="#181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers</a></li>
<li><a href="#183-customers-who-never-order">183. Customers Who Never Order</a></li>
<li><a href="#184-department-highest-salary">184. Department Highest Salary</a></li>
<li><a href="#176-second-highest-salary">176. Second Highest Salary</a></li>
<li><a href="#177-nth-highest-salary">177. Nth Highest Salary</a></li>
<li><a href="#178-rank-scores">178. Rank Scores</a></li>
<li><a href="#180-consecutive-numbers">180. Consecutive Numbers</a></li>
<li><a href="#626-exchange-seats">626. Exchange Seats</a></li>
</ul>
</li>
</ul>
<!-- GFM-TOC -->
<h2 id="595-big-countries">595. Big Countries<a hidden class="anchor" aria-hidden="true" href="#595-big-countries">#</a></h2>
<p><a href="https://leetcode.com/problems/big-countries/description/">https://leetcode.com/problems/big-countries/description/</a></p>
<<<<<<< HEAD
<h3 id="description">Description</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-----------------+------------+------------+--------------+---------------+
| name            | continent  | area       | population   | gdp           |
+-----------------+------------+------------+--------------+---------------+
| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |
| Albania         | Europe     | 28748      | 2831741      | 12960000      |
| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |
| Andorra         | Europe     | 468        | 78115        | 3712000       |
| Angola          | Africa     | 1246700    | 20609294     | 100990000     |
+-----------------+------------+------------+--------------+---------------+
</code></pre></div><p>查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+--------------+-------------+--------------+
| name         | population  | area         |
+--------------+-------------+--------------+
| Afghanistan  | 25500100    | 652230       |
| Algeria      | 37100000    | 2381741      |
+--------------+-------------+--------------+
</code></pre></div><h3 id="solution">Solution</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> name,
    population,
    area
<span style="color:#66d9ef">FROM</span>
    World
<span style="color:#66d9ef">WHERE</span>
    area <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3000000</span>
    <span style="color:#66d9ef">OR</span> population <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">25000000</span>;
</code></pre></div><h3 id="sql-schema">SQL Schema</h3>
<p>SQL Schema 用于在本地环境下创建表结构并导入数据，从而方便在本地环境调试。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> World;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> World ( NAME VARCHAR ( <span style="color:#ae81ff">255</span> ), continent VARCHAR ( <span style="color:#ae81ff">255</span> ), area INT, population INT, gdp INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> World ( NAME, continent, area, population, gdp )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#e6db74">&#39;Afghanistan&#39;</span>, <span style="color:#e6db74">&#39;Asia&#39;</span>, <span style="color:#e6db74">&#39;652230&#39;</span>, <span style="color:#e6db74">&#39;25500100&#39;</span>, <span style="color:#e6db74">&#39;203430000&#39;</span> ),
    ( <span style="color:#e6db74">&#39;Albania&#39;</span>, <span style="color:#e6db74">&#39;Europe&#39;</span>, <span style="color:#e6db74">&#39;28748&#39;</span>, <span style="color:#e6db74">&#39;2831741&#39;</span>, <span style="color:#e6db74">&#39;129600000&#39;</span> ),
    ( <span style="color:#e6db74">&#39;Algeria&#39;</span>, <span style="color:#e6db74">&#39;Africa&#39;</span>, <span style="color:#e6db74">&#39;2381741&#39;</span>, <span style="color:#e6db74">&#39;37100000&#39;</span>, <span style="color:#e6db74">&#39;1886810000&#39;</span> ),
    ( <span style="color:#e6db74">&#39;Andorra&#39;</span>, <span style="color:#e6db74">&#39;Europe&#39;</span>, <span style="color:#e6db74">&#39;468&#39;</span>, <span style="color:#e6db74">&#39;78115&#39;</span>, <span style="color:#e6db74">&#39;37120000&#39;</span> ),
    ( <span style="color:#e6db74">&#39;Angola&#39;</span>, <span style="color:#e6db74">&#39;Africa&#39;</span>, <span style="color:#e6db74">&#39;1246700&#39;</span>, <span style="color:#e6db74">&#39;20609294&#39;</span>, <span style="color:#e6db74">&#39;1009900000&#39;</span> );
</code></pre></div><h2 id="627-swap-salary">627. Swap Salary</h2>
<p><a href="https://leetcode.com/problems/swap-salary/description/">https://leetcode.com/problems/swap-salary/description/</a></p>
<h3 id="description-1">Description</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | m   | 2500   |
| 2  | B    | f   | 1500   |
| 3  | C    | m   | 5500   |
| 4  | D    | f   | 500    |
</code></pre></div><p>只用一个 SQL 查询，将 sex 字段反转。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | f   | 2500   |
| 2  | B    | m   | 1500   |
| 3  | C    | f   | 5500   |
| 4  | D    | m   | 500    |
</code></pre></div><h3 id="solution-1">Solution</h3>
<p>两个相等的数异或的结果为 0，而 0 与任何一个数异或的结果为这个数。</p>
<p>sex  字段只有两个取值：&lsquo;f&rsquo; 和 &rsquo;m'，并且有以下规律：</p>
<pre tabindex="0"><code>'f' ^ ('m' ^ 'f') = 'm' ^ ('f' ^ 'f') = 'm'
'm' ^ ('m' ^ 'f') = 'f' ^ ('m' ^ 'm') = 'f'
</code></pre><p>因此将 sex 字段和 &rsquo;m' ^ &lsquo;f&rsquo; 进行异或操作，最后就能反转 sex 字段。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">UPDATE</span> salary
<span style="color:#66d9ef">SET</span> sex <span style="color:#f92672">=</span> CHAR ( ASCII(sex) <span style="color:#f92672">^</span> ASCII( <span style="color:#e6db74">&#39;m&#39;</span> ) <span style="color:#f92672">^</span> ASCII( <span style="color:#e6db74">&#39;f&#39;</span> ) );
</code></pre></div><h3 id="sql-schema-1">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> salary;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> salary ( id INT, NAME VARCHAR ( <span style="color:#ae81ff">100</span> ), sex CHAR ( <span style="color:#ae81ff">1</span> ), salary INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> salary ( id, NAME, sex, salary )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;m&#39;</span>, <span style="color:#e6db74">&#39;2500&#39;</span> ),
    ( <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;1500&#39;</span> ),
    ( <span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;m&#39;</span>, <span style="color:#e6db74">&#39;5500&#39;</span> ),
    ( <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;f&#39;</span>, <span style="color:#e6db74">&#39;500&#39;</span> );
</code></pre></div><h2 id="620-not-boring-movies">620. Not Boring Movies</h2>
<p><a href="https://leetcode.com/problems/not-boring-movies/description/">https://leetcode.com/problems/not-boring-movies/description/</a></p>
<h3 id="description-2">Description</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+-----------+--------------+-----------+
|   id    | movie     |  description |  rating   |
+---------+-----------+--------------+-----------+
|   1     | War       |   great 3D   |   8.9     |
|   2     | Science   |   fiction    |   8.5     |
|   3     | irish     |   boring     |   6.2     |
|   4     | Ice song  |   Fantacy    |   8.6     |
|   5     | House card|   Interesting|   9.1     |
+---------+-----------+--------------+-----------+
</code></pre></div><p>查找 id 为奇数，并且 description 不是 boring 的电影，按 rating 降序。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+-----------+--------------+-----------+
|   id    | movie     |  description |  rating   |
+---------+-----------+--------------+-----------+
|   5     | House card|   Interesting|   9.1     |
|   1     | War       |   great 3D   |   8.9     |
+---------+-----------+--------------+-----------+
</code></pre></div><h3 id="solution-2">Solution</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    <span style="color:#f92672">*</span>
<span style="color:#66d9ef">FROM</span>
    cinema
<span style="color:#66d9ef">WHERE</span>
    id <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">AND</span> description <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;boring&#39;</span>
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>
    rating <span style="color:#66d9ef">DESC</span>;
</code></pre></div><h3 id="sql-schema-2">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> cinema;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> cinema ( id INT, movie VARCHAR ( <span style="color:#ae81ff">255</span> ), description VARCHAR ( <span style="color:#ae81ff">255</span> ), rating FLOAT ( <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> cinema ( id, movie, description, rating )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;War&#39;</span>, <span style="color:#e6db74">&#39;great 3D&#39;</span>, <span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">9</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Science&#39;</span>, <span style="color:#e6db74">&#39;fiction&#39;</span>, <span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">5</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;irish&#39;</span>, <span style="color:#e6db74">&#39;boring&#39;</span>, <span style="color:#ae81ff">6</span>.<span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;Ice song&#39;</span>, <span style="color:#e6db74">&#39;Fantacy&#39;</span>, <span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">6</span> ),
    ( <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;House card&#39;</span>, <span style="color:#e6db74">&#39;Interesting&#39;</span>, <span style="color:#ae81ff">9</span>.<span style="color:#ae81ff">1</span> );
</code></pre></div><h2 id="596-classes-more-than-5-students">596. Classes More Than 5 Students</h2>
<p><a href="https://leetcode.com/problems/classes-more-than-5-students/description/">https://leetcode.com/problems/classes-more-than-5-students/description/</a></p>
<h3 id="description-3">Description</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+------------+
| student | class      |
+---------+------------+
| A       | Math       |
| B       | English    |
| C       | Math       |
| D       | Biology    |
| E       | Math       |
| F       | Computer   |
| G       | Math       |
| H       | Math       |
| I       | Math       |
+---------+------------+
</code></pre></div><p>查找有五名及以上 student 的 class。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+
| class   |
+---------+
| Math    |
+---------+
</code></pre></div><h3 id="solution-3">Solution</h3>
<p>对 class 列进行分组之后，再使用 count 汇总函数统计每个分组的记录个数，之后使用 HAVING 进行筛选。HAVING  针对分组进行筛选，而 WHERE 针对每个记录（行）进行筛选。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    <span style="color:#66d9ef">class</span>
<span style="color:#66d9ef">FROM</span>
    courses
<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>
    <span style="color:#66d9ef">class</span>
<span style="color:#66d9ef">HAVING</span>
    <span style="color:#66d9ef">count</span>( <span style="color:#66d9ef">DISTINCT</span> student ) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5</span>;
</code></pre></div><h3 id="sql-schema-3">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> courses;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> courses ( student VARCHAR ( <span style="color:#ae81ff">255</span> ), <span style="color:#66d9ef">class</span> VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> courses ( student, <span style="color:#66d9ef">class</span> )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> ),
    ( <span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;English&#39;</span> ),
    ( <span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> ),
    ( <span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#e6db74">&#39;Biology&#39;</span> ),
    ( <span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> ),
    ( <span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#e6db74">&#39;Computer&#39;</span> ),
    ( <span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> ),
    ( <span style="color:#e6db74">&#39;H&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> ),
    ( <span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#e6db74">&#39;Math&#39;</span> );
</code></pre></div><h2 id="182-duplicate-emails">182. Duplicate Emails</h2>
=======
<h3 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-----------------+------------+------------+--------------+---------------+
</span></span><span class="line"><span class="cl">| name            | continent  | area       | population   | gdp           |
</span></span><span class="line"><span class="cl">+-----------------+------------+------------+--------------+---------------+
</span></span><span class="line"><span class="cl">| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |
</span></span><span class="line"><span class="cl">| Albania         | Europe     | 28748      | 2831741      | 12960000      |
</span></span><span class="line"><span class="cl">| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |
</span></span><span class="line"><span class="cl">| Andorra         | Europe     | 468        | 78115        | 3712000       |
</span></span><span class="line"><span class="cl">| Angola          | Africa     | 1246700    | 20609294     | 100990000     |
</span></span><span class="line"><span class="cl">+-----------------+------------+------------+--------------+---------------+
</span></span></code></pre></div><p>查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+--------------+-------------+--------------+
</span></span><span class="line"><span class="cl">| name         | population  | area         |
</span></span><span class="line"><span class="cl">+--------------+-------------+--------------+
</span></span><span class="line"><span class="cl">| Afghanistan  | 25500100    | 652230       |
</span></span><span class="line"><span class="cl">| Algeria      | 37100000    | 2381741      |
</span></span><span class="line"><span class="cl">+--------------+-------------+--------------+
</span></span></code></pre></div><h3 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">population</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">area</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">World</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">area</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3000000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">population</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">25000000</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema">#</a></h3>
<p>SQL Schema 用于在本地环境下创建表结构并导入数据，从而方便在本地环境调试。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">World</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">continent</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">gdp</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">continent</span><span class="p">,</span><span class="w"> </span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">population</span><span class="p">,</span><span class="w"> </span><span class="n">gdp</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Afghanistan&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Asia&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;652230&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;25500100&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;203430000&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Albania&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Europe&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;28748&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2831741&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;129600000&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Algeria&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Africa&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2381741&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;37100000&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1886810000&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Andorra&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Europe&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;468&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;78115&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;37120000&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;Angola&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Africa&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1246700&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;20609294&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1009900000&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="627-swap-salary">627. Swap Salary<a hidden class="anchor" aria-hidden="true" href="#627-swap-salary">#</a></h2>
<p><a href="https://leetcode.com/problems/swap-salary/description/">https://leetcode.com/problems/swap-salary/description/</a></p>
<h3 id="description-1">Description<a hidden class="anchor" aria-hidden="true" href="#description-1">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">| id | name | sex | salary |
</span></span><span class="line"><span class="cl">|----|------|-----|--------|
</span></span><span class="line"><span class="cl">| 1  | A    | m   | 2500   |
</span></span><span class="line"><span class="cl">| 2  | B    | f   | 1500   |
</span></span><span class="line"><span class="cl">| 3  | C    | m   | 5500   |
</span></span><span class="line"><span class="cl">| 4  | D    | f   | 500    |
</span></span></code></pre></div><p>只用一个 SQL 查询，将 sex 字段反转。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">| id | name | sex | salary |
</span></span><span class="line"><span class="cl">|----|------|-----|--------|
</span></span><span class="line"><span class="cl">| 1  | A    | f   | 2500   |
</span></span><span class="line"><span class="cl">| 2  | B    | m   | 1500   |
</span></span><span class="line"><span class="cl">| 3  | C    | f   | 5500   |
</span></span><span class="line"><span class="cl">| 4  | D    | m   | 500    |
</span></span></code></pre></div><h3 id="solution-1">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-1">#</a></h3>
<p>两个相等的数异或的结果为 0，而 0 与任何一个数异或的结果为这个数。</p>
<p>sex  字段只有两个取值：&lsquo;f&rsquo; 和 &rsquo;m&rsquo;，并且有以下规律：</p>
<pre tabindex="0"><code>&#39;f&#39; ^ (&#39;m&#39; ^ &#39;f&#39;) = &#39;m&#39; ^ (&#39;f&#39; ^ &#39;f&#39;) = &#39;m&#39;
&#39;m&#39; ^ (&#39;m&#39; ^ &#39;f&#39;) = &#39;f&#39; ^ (&#39;m&#39; ^ &#39;m&#39;) = &#39;f&#39;
</code></pre><p>因此将 sex 字段和 &rsquo;m&rsquo; ^ &lsquo;f&rsquo; 进行异或操作，最后就能反转 sex 字段。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">CHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ASCII</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">ASCII</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">ASCII</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;f&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-1">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-1">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">salary</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="nb">CHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="p">,</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2500&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1500&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;5500&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;500&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="620-not-boring-movies">620. Not Boring Movies<a hidden class="anchor" aria-hidden="true" href="#620-not-boring-movies">#</a></h2>
<p><a href="https://leetcode.com/problems/not-boring-movies/description/">https://leetcode.com/problems/not-boring-movies/description/</a></p>
<h3 id="description-2">Description<a hidden class="anchor" aria-hidden="true" href="#description-2">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span><span class="line"><span class="cl">|   id    | movie     |  description |  rating   |
</span></span><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span><span class="line"><span class="cl">|   1     | War       |   great 3D   |   8.9     |
</span></span><span class="line"><span class="cl">|   2     | Science   |   fiction    |   8.5     |
</span></span><span class="line"><span class="cl">|   3     | irish     |   boring     |   6.2     |
</span></span><span class="line"><span class="cl">|   4     | Ice song  |   Fantacy    |   8.6     |
</span></span><span class="line"><span class="cl">|   5     | House card|   Interesting|   9.1     |
</span></span><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span></code></pre></div><p>查找 id 为奇数，并且 description 不是 boring 的电影，按 rating 降序。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span><span class="line"><span class="cl">|   id    | movie     |  description |  rating   |
</span></span><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span><span class="line"><span class="cl">|   5     | House card|   Interesting|   9.1     |
</span></span><span class="line"><span class="cl">|   1     | War       |   great 3D   |   8.9     |
</span></span><span class="line"><span class="cl">+---------+-----------+--------------+-----------+
</span></span></code></pre></div><h3 id="solution-2">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-2">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">cinema</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;boring&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">rating</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-2">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-2">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">cinema</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">rating</span><span class="w"> </span><span class="nb">FLOAT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">cinema</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">movie</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">rating</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;War&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;great 3D&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">9</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Science&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;fiction&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">5</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;irish&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;boring&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Ice song&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fantacy&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">.</span><span class="mi">6</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;House card&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Interesting&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="596-classes-more-than-5-students">596. Classes More Than 5 Students<a hidden class="anchor" aria-hidden="true" href="#596-classes-more-than-5-students">#</a></h2>
<p><a href="https://leetcode.com/problems/classes-more-than-5-students/description/">https://leetcode.com/problems/classes-more-than-5-students/description/</a></p>
<h3 id="description-3">Description<a hidden class="anchor" aria-hidden="true" href="#description-3">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+------------+
</span></span><span class="line"><span class="cl">| student | class      |
</span></span><span class="line"><span class="cl">+---------+------------+
</span></span><span class="line"><span class="cl">| A       | Math       |
</span></span><span class="line"><span class="cl">| B       | English    |
</span></span><span class="line"><span class="cl">| C       | Math       |
</span></span><span class="line"><span class="cl">| D       | Biology    |
</span></span><span class="line"><span class="cl">| E       | Math       |
</span></span><span class="line"><span class="cl">| F       | Computer   |
</span></span><span class="line"><span class="cl">| G       | Math       |
</span></span><span class="line"><span class="cl">| H       | Math       |
</span></span><span class="line"><span class="cl">| I       | Math       |
</span></span><span class="line"><span class="cl">+---------+------------+
</span></span></code></pre></div><p>查找有五名及以上 student 的 class。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+
</span></span><span class="line"><span class="cl">| class   |
</span></span><span class="line"><span class="cl">+---------+
</span></span><span class="line"><span class="cl">| Math    |
</span></span><span class="line"><span class="cl">+---------+
</span></span></code></pre></div><h3 id="solution-3">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-3">#</a></h3>
<p>对 class 列进行分组之后，再使用 count 汇总函数统计每个分组的记录个数，之后使用 HAVING 进行筛选。HAVING  针对分组进行筛选，而 WHERE 针对每个记录（行）进行筛选。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">courses</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">class</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">count</span><span class="p">(</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-3">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-3">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">courses</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">courses</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">courses</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">student</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;English&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Biology&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Computer&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Math&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="182-duplicate-emails">182. Duplicate Emails<a hidden class="anchor" aria-hidden="true" href="#182-duplicate-emails">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/duplicate-emails/description/">https://leetcode.com/problems/duplicate-emails/description/</a></p>
<h3 id="description-4">Description<a hidden class="anchor" aria-hidden="true" href="#description-4">#</a></h3>
<p>邮件地址表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+---------+
| Id | Email   |
+----+---------+
| 1  | a@b.com |
| 2  | c@d.com |
| 3  | a@b.com |
+----+---------+
</code></pre></div><p>查找重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+
| Email   |
+---------+
| a@b.com |
+---------+
</code></pre></div><h3 id="solution-4">Solution</h3>
<p>对 Email 进行分组，如果并使用 COUNT 进行计数统计，结果大于等于 2 的表示 Email  重复。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    Email
<span style="color:#66d9ef">FROM</span>
    Person
<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>
    Email
<span style="color:#66d9ef">HAVING</span>
    <span style="color:#66d9ef">COUNT</span>( <span style="color:#f92672">*</span> ) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span>;
</code></pre></div><h3 id="sql-schema-4">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Person;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Person ( Id INT, Email VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Person ( Id, Email )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;a@b.com&#39;</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;c@d.com&#39;</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;a@b.com&#39;</span> );
</code></pre></div><h2 id="196-delete-duplicate-emails">196. Delete Duplicate Emails</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+---------+
</span></span><span class="line"><span class="cl">| Id | Email   |
</span></span><span class="line"><span class="cl">+----+---------+
</span></span><span class="line"><span class="cl">| 1  | a@b.com |
</span></span><span class="line"><span class="cl">| 2  | c@d.com |
</span></span><span class="line"><span class="cl">| 3  | a@b.com |
</span></span><span class="line"><span class="cl">+----+---------+
</span></span></code></pre></div><p>查找重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+
</span></span><span class="line"><span class="cl">| Email   |
</span></span><span class="line"><span class="cl">+---------+
</span></span><span class="line"><span class="cl">| a@b.com |
</span></span><span class="line"><span class="cl">+---------+
</span></span></code></pre></div><h3 id="solution-4">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-4">#</a></h3>
<p>对 Email 进行分组，如果并使用 COUNT 进行计数统计，结果大于等于 2 的表示 Email  重复。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-4">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-4">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Person</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Email</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a@b.com&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c@d.com&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a@b.com&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="196-delete-duplicate-emails">196. Delete Duplicate Emails<a hidden class="anchor" aria-hidden="true" href="#196-delete-duplicate-emails">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/delete-duplicate-emails/description/">https://leetcode.com/problems/delete-duplicate-emails/description/</a></p>
<h3 id="description-5">Description<a hidden class="anchor" aria-hidden="true" href="#description-5">#</a></h3>
<p>邮件地址表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+---------+
| Id | Email   |
+----+---------+
| 1  | john@example.com |
| 2  | bob@example.com |
| 3  | john@example.com |
+----+---------+
</code></pre></div><p>删除重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+------------------+
| Id | Email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
</code></pre></div><h3 id="solution-5">Solution</h3>
<p>只保留相同 Email 中 Id 最小的那一个，然后删除其它的。</p>
<p>连接查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DELETE</span> p1
<span style="color:#66d9ef">FROM</span>
    Person p1,
    Person p2
<span style="color:#66d9ef">WHERE</span>
    p1.Email <span style="color:#f92672">=</span> p2.Email
    <span style="color:#66d9ef">AND</span> p1.Id <span style="color:#f92672">&gt;</span> p2.Id
</code></pre></div><p>子查询：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DELETE</span>
<span style="color:#66d9ef">FROM</span>
    Person
<span style="color:#66d9ef">WHERE</span>
    id <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> (
        <span style="color:#66d9ef">SELECT</span> id 
        <span style="color:#66d9ef">FROM</span> ( 
            <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>( id ) <span style="color:#66d9ef">AS</span> id 
            <span style="color:#66d9ef">FROM</span> Person
            <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> email
        ) <span style="color:#66d9ef">AS</span> m
    );
</code></pre></div><p>应该注意的是上述解法额外嵌套了一个 SELECT 语句，如果不这么做，会出现错误：You can&rsquo;t specify target table &lsquo;Person&rsquo; for update in FROM clause。以下演示了这种错误解法。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DELETE</span>
<span style="color:#66d9ef">FROM</span>
    Person
<span style="color:#66d9ef">WHERE</span>
    id <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> ( 
        <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">min</span>( id ) <span style="color:#66d9ef">AS</span> id 
        <span style="color:#66d9ef">FROM</span> Person 
        <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> email 
    );
</code></pre></div><p>参考：<a href="https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause">pMySQL Error 1093 - Can&rsquo;t specify target table for update in FROM clause</a></p>
<h3 id="sql-schema-5">SQL Schema</h3>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+---------+
</span></span><span class="line"><span class="cl">| Id | Email   |
</span></span><span class="line"><span class="cl">+----+---------+
</span></span><span class="line"><span class="cl">| 1  | john@example.com |
</span></span><span class="line"><span class="cl">| 2  | bob@example.com |
</span></span><span class="line"><span class="cl">| 3  | john@example.com |
</span></span><span class="line"><span class="cl">+----+---------+
</span></span></code></pre></div><p>删除重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+------------------+
</span></span><span class="line"><span class="cl">| Id | Email            |
</span></span><span class="line"><span class="cl">+----+------------------+
</span></span><span class="line"><span class="cl">| 1  | john@example.com |
</span></span><span class="line"><span class="cl">| 2  | bob@example.com  |
</span></span><span class="line"><span class="cl">+----+------------------+
</span></span></code></pre></div><h3 id="solution-5">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-5">#</a></h3>
<p>只保留相同 Email 中 Id 最小的那一个，然后删除其它的。</p>
<p>连接查询：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="n">p1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w"> </span><span class="n">p2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">p1</span><span class="p">.</span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">Email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">p2</span><span class="p">.</span><span class="n">Id</span><span class="w">
</span></span></span></code></pre></div><p>子查询：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">SELECT</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">email</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>应该注意的是上述解法额外嵌套了一个 SELECT 语句，如果不这么做，会出现错误：You can&rsquo;t specify target table &lsquo;Person&rsquo; for update in FROM clause。以下演示了这种错误解法。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Person</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">email</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>参考：<a href="https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause">pMySQL Error 1093 - Can&rsquo;t specify target table for update in FROM clause</a></p>
<h3 id="sql-schema-5">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-5">#</a></h3>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p>与 182 相同。</p>
<h2 id="175-combine-two-tables">175. Combine Two Tables<a hidden class="anchor" aria-hidden="true" href="#175-combine-two-tables">#</a></h2>
<p><a href="https://leetcode.com/problems/combine-two-tables/description/">https://leetcode.com/problems/combine-two-tables/description/</a></p>
<h3 id="description-6">Description<a hidden class="anchor" aria-hidden="true" href="#description-6">#</a></h3>
<p>Person 表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| PersonId    | int     |
| FirstName   | varchar |
| LastName    | varchar |
+-------------+---------+
PersonId is the primary key column for this table.
</code></pre></div><p>Address 表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| AddressId   | int     |
| PersonId    | int     |
| City        | varchar |
| State       | varchar |
+-------------+---------+
AddressId is the primary key column for this table.
</code></pre></div><p>查找 FirstName, LastName, City, State 数据，而不管一个用户有没有填地址信息。</p>
<h3 id="solution-6">Solution</h3>
<p>涉及到 Person 和 Address 两个表，在对这两个表执行连接操作时，因为要保留 Person 表中的信息，即使在 Address 表中没有关联的信息也要保留。此时可以用左外连接，将 Person 表放在 LEFT JOIN 的左边。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    FirstName,
    LastName,
    City,
    <span style="color:#66d9ef">State</span>
<span style="color:#66d9ef">FROM</span>
    Person P
    <span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">JOIN</span> Address A
    <span style="color:#66d9ef">ON</span> P.PersonId <span style="color:#f92672">=</span> A.PersonId;
</code></pre></div><h3 id="sql-schema-6">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Person;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Person ( PersonId INT, FirstName VARCHAR ( <span style="color:#ae81ff">255</span> ), LastName VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Address;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Address ( AddressId INT, PersonId INT, City VARCHAR ( <span style="color:#ae81ff">255</span> ), <span style="color:#66d9ef">State</span> VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Person ( PersonId, LastName, FirstName )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Wang&#39;</span>, <span style="color:#e6db74">&#39;Allen&#39;</span> );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Address ( AddressId, PersonId, City, <span style="color:#66d9ef">State</span> )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;New York City&#39;</span>, <span style="color:#e6db74">&#39;New York&#39;</span> );
</code></pre></div><h2 id="181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">| Column Name | Type    |
</span></span><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">| PersonId    | int     |
</span></span><span class="line"><span class="cl">| FirstName   | varchar |
</span></span><span class="line"><span class="cl">| LastName    | varchar |
</span></span><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">PersonId is the primary key column for this table.
</span></span></code></pre></div><p>Address 表：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">| Column Name | Type    |
</span></span><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">| AddressId   | int     |
</span></span><span class="line"><span class="cl">| PersonId    | int     |
</span></span><span class="line"><span class="cl">| City        | varchar |
</span></span><span class="line"><span class="cl">| State       | varchar |
</span></span><span class="line"><span class="cl">+-------------+---------+
</span></span><span class="line"><span class="cl">AddressId is the primary key column for this table.
</span></span></code></pre></div><p>查找 FirstName, LastName, City, State 数据，而不管一个用户有没有填地址信息。</p>
<h3 id="solution-6">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-6">#</a></h3>
<p>涉及到 Person 和 Address 两个表，在对这两个表执行连接操作时，因为要保留 Person 表中的信息，即使在 Address 表中没有关联的信息也要保留。此时可以用左外连接，将 Person 表放在 LEFT JOIN 的左边。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">FirstName</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">LastName</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">City</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">State</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Person</span><span class="w"> </span><span class="n">P</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">A</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">P</span><span class="p">.</span><span class="n">PersonId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">PersonId</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-6">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-6">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Person</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">PersonId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">FirstName</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">LastName</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Address</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">AddressId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">PersonId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">PersonId</span><span class="p">,</span><span class="w"> </span><span class="n">LastName</span><span class="p">,</span><span class="w"> </span><span class="n">FirstName</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Wang&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Allen&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">AddressId</span><span class="p">,</span><span class="w"> </span><span class="n">PersonId</span><span class="p">,</span><span class="w"> </span><span class="n">City</span><span class="p">,</span><span class="w"> </span><span class="k">State</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;New York City&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;New York&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers<a hidden class="anchor" aria-hidden="true" href="#181-employees-earning-more-than-their-managers">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/description/">https://leetcode.com/problems/employees-earning-more-than-their-managers/description/</a></p>
<h3 id="description-7">Description<a hidden class="anchor" aria-hidden="true" href="#description-7">#</a></h3>
<p>Employee 表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+-------+--------+-----------+
| Id | Name  | Salary | ManagerId |
+----+-------+--------+-----------+
| 1  | Joe   | 70000  | 3         |
| 2  | Henry | 80000  | 4         |
| 3  | Sam   | 60000  | NULL      |
| 4  | Max   | 90000  | NULL      |
+----+-------+--------+-----------+
</code></pre></div><p>查找薪资大于其经理薪资的员工信息。</p>
<h3 id="solution-7">Solution</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    E1.NAME <span style="color:#66d9ef">AS</span> Employee
<span style="color:#66d9ef">FROM</span>
    Employee E1
    <span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> Employee E2
    <span style="color:#66d9ef">ON</span> E1.ManagerId <span style="color:#f92672">=</span> E2.Id
    <span style="color:#66d9ef">AND</span> E1.Salary <span style="color:#f92672">&gt;</span> E2.Salary;
</code></pre></div><h3 id="sql-schema-7">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Employee;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Employee ( Id INT, NAME VARCHAR ( <span style="color:#ae81ff">255</span> ), Salary INT, ManagerId INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Employee ( Id, NAME, Salary, ManagerId )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Joe&#39;</span>, <span style="color:#ae81ff">70000</span>, <span style="color:#ae81ff">3</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Henry&#39;</span>, <span style="color:#ae81ff">80000</span>, <span style="color:#ae81ff">4</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;Sam&#39;</span>, <span style="color:#ae81ff">60000</span>, <span style="color:#66d9ef">NULL</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;Max&#39;</span>, <span style="color:#ae81ff">90000</span>, <span style="color:#66d9ef">NULL</span> );
</code></pre></div><h2 id="183-customers-who-never-order">183. Customers Who Never Order</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+-------+--------+-----------+
</span></span><span class="line"><span class="cl">| Id | Name  | Salary | ManagerId |
</span></span><span class="line"><span class="cl">+----+-------+--------+-----------+
</span></span><span class="line"><span class="cl">| 1  | Joe   | 70000  | 3         |
</span></span><span class="line"><span class="cl">| 2  | Henry | 80000  | 4         |
</span></span><span class="line"><span class="cl">| 3  | Sam   | 60000  | NULL      |
</span></span><span class="line"><span class="cl">| 4  | Max   | 90000  | NULL      |
</span></span><span class="line"><span class="cl">+----+-------+--------+-----------+
</span></span></code></pre></div><p>查找薪资大于其经理薪资的员工信息。</p>
<h3 id="solution-7">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-7">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">E1</span><span class="p">.</span><span class="n">NAME</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Employee</span><span class="w"> </span><span class="n">E1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="n">E2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">E1</span><span class="p">.</span><span class="n">ManagerId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E2</span><span class="p">.</span><span class="n">Id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">E1</span><span class="p">.</span><span class="n">Salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">E2</span><span class="p">.</span><span class="n">Salary</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-7">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-7">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Employee</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">ManagerId</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">Salary</span><span class="p">,</span><span class="w"> </span><span class="n">ManagerId</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Joe&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">70000</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Henry&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">80000</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sam&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Max&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90000</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="183-customers-who-never-order">183. Customers Who Never Order<a hidden class="anchor" aria-hidden="true" href="#183-customers-who-never-order">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/customers-who-never-order/description/">https://leetcode.com/problems/customers-who-never-order/description/</a></p>
<h3 id="description-8">Description<a hidden class="anchor" aria-hidden="true" href="#description-8">#</a></h3>
<p>Customers 表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+-------+
| Id | Name  |
+----+-------+
| 1  | Joe   |
| 2  | Henry |
| 3  | Sam   |
| 4  | Max   |
+----+-------+
</code></pre></div><p>Orders 表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+------------+
| Id | CustomerId |
+----+------------+
| 1  | 3          |
| 2  | 1          |
+----+------------+
</code></pre></div><p>查找没有订单的顾客信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-----------+
| Customers |
+-----------+
| Henry     |
| Max       |
+-----------+
</code></pre></div><h3 id="solution-8">Solution</h3>
<p>左外链接</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    <span style="color:#66d9ef">C</span>.Name <span style="color:#66d9ef">AS</span> Customers
<span style="color:#66d9ef">FROM</span>
    Customers <span style="color:#66d9ef">C</span>
    <span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">JOIN</span> Orders O
    <span style="color:#66d9ef">ON</span> <span style="color:#66d9ef">C</span>.Id <span style="color:#f92672">=</span> O.CustomerId
<span style="color:#66d9ef">WHERE</span>
    O.CustomerId <span style="color:#66d9ef">IS</span> <span style="color:#66d9ef">NULL</span>;
</code></pre></div><p>子查询</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    Name <span style="color:#66d9ef">AS</span> Customers
<span style="color:#66d9ef">FROM</span>
    Customers
<span style="color:#66d9ef">WHERE</span>
    Id <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">IN</span> ( 
        <span style="color:#66d9ef">SELECT</span> CustomerId 
        <span style="color:#66d9ef">FROM</span> Orders 
    );
</code></pre></div><h3 id="sql-schema-8">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Customers;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Customers ( Id INT, NAME VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Orders;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Orders ( Id INT, CustomerId INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Customers ( Id, NAME )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Joe&#39;</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Henry&#39;</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;Sam&#39;</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;Max&#39;</span> );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Orders ( Id, CustomerId )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span> );
</code></pre></div><h2 id="184-department-highest-salary">184. Department Highest Salary</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+-------+
</span></span><span class="line"><span class="cl">| Id | Name  |
</span></span><span class="line"><span class="cl">+----+-------+
</span></span><span class="line"><span class="cl">| 1  | Joe   |
</span></span><span class="line"><span class="cl">| 2  | Henry |
</span></span><span class="line"><span class="cl">| 3  | Sam   |
</span></span><span class="line"><span class="cl">| 4  | Max   |
</span></span><span class="line"><span class="cl">+----+-------+
</span></span></code></pre></div><p>Orders 表：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+------------+
</span></span><span class="line"><span class="cl">| Id | CustomerId |
</span></span><span class="line"><span class="cl">+----+------------+
</span></span><span class="line"><span class="cl">| 1  | 3          |
</span></span><span class="line"><span class="cl">| 2  | 1          |
</span></span><span class="line"><span class="cl">+----+------------+
</span></span></code></pre></div><p>查找没有订单的顾客信息：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-----------+
</span></span><span class="line"><span class="cl">| Customers |
</span></span><span class="line"><span class="cl">+-----------+
</span></span><span class="line"><span class="cl">| Henry     |
</span></span><span class="line"><span class="cl">| Max       |
</span></span><span class="line"><span class="cl">+-----------+
</span></span></code></pre></div><h3 id="solution-8">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-8">#</a></h3>
<p>左外链接</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">C</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Customers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Customers</span><span class="w"> </span><span class="k">C</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Orders</span><span class="w"> </span><span class="n">O</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="k">C</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">O</span><span class="p">.</span><span class="n">CustomerId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">O</span><span class="p">.</span><span class="n">CustomerId</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>子查询</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">Customers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Customers</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Id</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">CustomerId</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Orders</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-8">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-8">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Customers</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Customers</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Orders</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Orders</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerId</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Customers</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Joe&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Henry&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sam&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Max&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Orders</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerId</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="184-department-highest-salary">184. Department Highest Salary<a hidden class="anchor" aria-hidden="true" href="#184-department-highest-salary">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/department-highest-salary/description/">https://leetcode.com/problems/department-highest-salary/description/</a></p>
<h3 id="description-9">Description<a hidden class="anchor" aria-hidden="true" href="#description-9">#</a></h3>
<p>Employee 表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+-------+--------+--------------+
| Id | Name  | Salary | DepartmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Henry | 80000  | 2            |
| 3  | Sam   | 60000  | 2            |
| 4  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
</code></pre></div><p>Department 表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+----------+
| Id | Name     |
+----+----------+
| 1  | IT       |
| 2  | Sales    |
+----+----------+
</code></pre></div><p>查找一个 Department 中收入最高者的信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Max      | 90000  |
| Sales      | Henry    | 80000  |
+------------+----------+--------+
</code></pre></div><h3 id="solution-9">Solution</h3>
<p>创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。</p>
<p>之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    D.NAME Department,
    E.NAME Employee,
    E.Salary
<span style="color:#66d9ef">FROM</span>
    Employee E,
    Department D,
    ( <span style="color:#66d9ef">SELECT</span> DepartmentId, <span style="color:#66d9ef">MAX</span>( Salary ) Salary 
     <span style="color:#66d9ef">FROM</span> Employee 
     <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> DepartmentId ) M
<span style="color:#66d9ef">WHERE</span>
    E.DepartmentId <span style="color:#f92672">=</span> D.Id
    <span style="color:#66d9ef">AND</span> E.DepartmentId <span style="color:#f92672">=</span> M.DepartmentId
    <span style="color:#66d9ef">AND</span> E.Salary <span style="color:#f92672">=</span> M.Salary;
</code></pre></div><h3 id="sql-schema-9">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> Employee;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Employee ( Id INT, NAME VARCHAR ( <span style="color:#ae81ff">255</span> ), Salary INT, DepartmentId INT );
<span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> Department;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Department ( Id INT, NAME VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Employee ( Id, NAME, Salary, DepartmentId )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;Joe&#39;</span>, <span style="color:#ae81ff">70000</span>, <span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Henry&#39;</span>, <span style="color:#ae81ff">80000</span>, <span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;Sam&#39;</span>, <span style="color:#ae81ff">60000</span>, <span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;Max&#39;</span>, <span style="color:#ae81ff">90000</span>, <span style="color:#ae81ff">1</span> );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Department ( Id, NAME )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;IT&#39;</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;Sales&#39;</span> );
</code></pre></div><h2 id="176-second-highest-salary">176. Second Highest Salary</h2>
<p><a href="https://leetcode.com/problems/second-highest-salary/description/">https://leetcode.com/problems/second-highest-salary/description/</a></p>
<h3 id="description-10">Description</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
</code></pre></div><p>查找工资第二高的员工。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
</code></pre></div><p>没有找到返回 null 而不是不返回数据。</p>
<h3 id="solution-10">Solution</h3>
<p>为了在没有查找到数据时返回 null，需要在查询结果外面再套一层 SELECT。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    ( <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> Salary 
     <span style="color:#66d9ef">FROM</span> Employee 
     <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> Salary <span style="color:#66d9ef">DESC</span> 
     <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span> ) SecondHighestSalary;
</code></pre></div><h3 id="sql-schema-10">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Employee;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Employee ( Id INT, Salary INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Employee ( Id, Salary )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">100</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">200</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">300</span> );
</code></pre></div><h2 id="177-nth-highest-salary">177. Nth Highest Salary</h2>
<h3 id="description-11">Description</h3>
<p>查找工资第 N 高的员工。</p>
<h3 id="solution-11">Solution</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">FUNCTION</span> getNthHighestSalary ( N INT ) <span style="color:#66d9ef">RETURNS</span> INT <span style="color:#66d9ef">BEGIN</span>

<span style="color:#66d9ef">SET</span> N <span style="color:#f92672">=</span> N <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">RETURN</span> ( 
    <span style="color:#66d9ef">SELECT</span> ( 
        <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">DISTINCT</span> Salary 
        <span style="color:#66d9ef">FROM</span> Employee 
        <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> Salary <span style="color:#66d9ef">DESC</span> 
        <span style="color:#66d9ef">LIMIT</span> N, <span style="color:#ae81ff">1</span> 
    ) 
);

<span style="color:#66d9ef">END</span>
</code></pre></div><h3 id="sql-schema-11">SQL Schema</h3>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+-------+--------+--------------+
</span></span><span class="line"><span class="cl">| Id | Name  | Salary | DepartmentId |
</span></span><span class="line"><span class="cl">+----+-------+--------+--------------+
</span></span><span class="line"><span class="cl">| 1  | Joe   | 70000  | 1            |
</span></span><span class="line"><span class="cl">| 2  | Henry | 80000  | 2            |
</span></span><span class="line"><span class="cl">| 3  | Sam   | 60000  | 2            |
</span></span><span class="line"><span class="cl">| 4  | Max   | 90000  | 1            |
</span></span><span class="line"><span class="cl">+----+-------+--------+--------------+
</span></span></code></pre></div><p>Department 表：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+----------+
</span></span><span class="line"><span class="cl">| Id | Name     |
</span></span><span class="line"><span class="cl">+----+----------+
</span></span><span class="line"><span class="cl">| 1  | IT       |
</span></span><span class="line"><span class="cl">| 2  | Sales    |
</span></span><span class="line"><span class="cl">+----+----------+
</span></span></code></pre></div><p>查找一个 Department 中收入最高者的信息：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+------------+----------+--------+
</span></span><span class="line"><span class="cl">| Department | Employee | Salary |
</span></span><span class="line"><span class="cl">+------------+----------+--------+
</span></span><span class="line"><span class="cl">| IT         | Max      | 90000  |
</span></span><span class="line"><span class="cl">| Sales      | Henry    | 80000  |
</span></span><span class="line"><span class="cl">+------------+----------+--------+
</span></span></code></pre></div><h3 id="solution-9">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-9">#</a></h3>
<p>创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。</p>
<p>之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">D</span><span class="p">.</span><span class="n">NAME</span><span class="w"> </span><span class="n">Department</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">E</span><span class="p">.</span><span class="n">NAME</span><span class="w"> </span><span class="n">Employee</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">E</span><span class="p">.</span><span class="n">Salary</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Employee</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Department</span><span class="w"> </span><span class="n">D</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">DepartmentId</span><span class="p">,</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">Salary</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">DepartmentId</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">M</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">E</span><span class="p">.</span><span class="n">DepartmentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="p">.</span><span class="n">Id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">E</span><span class="p">.</span><span class="n">DepartmentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="p">.</span><span class="n">DepartmentId</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">E</span><span class="p">.</span><span class="n">Salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M</span><span class="p">.</span><span class="n">Salary</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-9">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-9">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Employee</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">DepartmentId</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Department</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Department</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">Salary</span><span class="p">,</span><span class="w"> </span><span class="n">DepartmentId</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Joe&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">70000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Henry&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">80000</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sam&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">60000</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Max&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">90000</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Department</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IT&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sales&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="176-second-highest-salary">176. Second Highest Salary<a hidden class="anchor" aria-hidden="true" href="#176-second-highest-salary">#</a></h2>
<p><a href="https://leetcode.com/problems/second-highest-salary/description/">https://leetcode.com/problems/second-highest-salary/description/</a></p>
<h3 id="description-10">Description<a hidden class="anchor" aria-hidden="true" href="#description-10">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+--------+
</span></span><span class="line"><span class="cl">| Id | Salary |
</span></span><span class="line"><span class="cl">+----+--------+
</span></span><span class="line"><span class="cl">| 1  | 100    |
</span></span><span class="line"><span class="cl">| 2  | 200    |
</span></span><span class="line"><span class="cl">| 3  | 300    |
</span></span><span class="line"><span class="cl">+----+--------+
</span></span></code></pre></div><p>查找工资第二高的员工。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------------------+
</span></span><span class="line"><span class="cl">| SecondHighestSalary |
</span></span><span class="line"><span class="cl">+---------------------+
</span></span><span class="line"><span class="cl">| 200                 |
</span></span><span class="line"><span class="cl">+---------------------+
</span></span></code></pre></div><p>没有找到返回 null 而不是不返回数据。</p>
<h3 id="solution-10">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-10">#</a></h3>
<p>为了在没有查找到数据时返回 null，需要在查询结果外面再套一层 SELECT。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Salary</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="k">DESC</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">SecondHighestSalary</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-10">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-10">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Employee</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="177-nth-highest-salary">177. Nth Highest Salary<a hidden class="anchor" aria-hidden="true" href="#177-nth-highest-salary">#</a></h2>
<h3 id="description-11">Description<a hidden class="anchor" aria-hidden="true" href="#description-11">#</a></h3>
<p>查找工资第 N 高的员工。</p>
<h3 id="solution-11">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-11">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">getNthHighestSalary</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="p">(</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">Salary</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">Employee</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="k">DESC</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">LIMIT</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-11">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-11">#</a></h3>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p>同 176。</p>
<h2 id="178-rank-scores">178. Rank Scores<a hidden class="anchor" aria-hidden="true" href="#178-rank-scores">#</a></h2>
<p><a href="https://leetcode.com/problems/rank-scores/description/">https://leetcode.com/problems/rank-scores/description/</a></p>
<h3 id="description-12">Description<a hidden class="anchor" aria-hidden="true" href="#description-12">#</a></h3>
<p>得分表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+-------+
| Id | Score |
+----+-------+
| 1  | 3.50  |
| 2  | 3.65  |
| 3  | 4.00  |
| 4  | 3.85  |
| 5  | 4.00  |
| 6  | 3.65  |
+----+-------+
</code></pre></div><p>将得分排序，并统计排名。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-------+------+
| Score | Rank |
+-------+------+
| 4.00  | 1    |
| 4.00  | 1    |
| 3.85  | 2    |
| 3.65  | 3    |
| 3.65  | 3    |
| 3.50  | 4    |
+-------+------+
</code></pre></div><h3 id="solution-12">Solution</h3>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+-------+
</span></span><span class="line"><span class="cl">| Id | Score |
</span></span><span class="line"><span class="cl">+----+-------+
</span></span><span class="line"><span class="cl">| 1  | 3.50  |
</span></span><span class="line"><span class="cl">| 2  | 3.65  |
</span></span><span class="line"><span class="cl">| 3  | 4.00  |
</span></span><span class="line"><span class="cl">| 4  | 3.85  |
</span></span><span class="line"><span class="cl">| 5  | 4.00  |
</span></span><span class="line"><span class="cl">| 6  | 3.65  |
</span></span><span class="line"><span class="cl">+----+-------+
</span></span></code></pre></div><p>将得分排序，并统计排名。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-------+------+
</span></span><span class="line"><span class="cl">| Score | Rank |
</span></span><span class="line"><span class="cl">+-------+------+
</span></span><span class="line"><span class="cl">| 4.00  | 1    |
</span></span><span class="line"><span class="cl">| 4.00  | 1    |
</span></span><span class="line"><span class="cl">| 3.85  | 2    |
</span></span><span class="line"><span class="cl">| 3.65  | 3    |
</span></span><span class="line"><span class="cl">| 3.65  | 3    |
</span></span><span class="line"><span class="cl">| 3.50  | 4    |
</span></span><span class="line"><span class="cl">+-------+------+
</span></span></code></pre></div><h3 id="solution-12">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-12">#</a></h3>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p>要统计某个 score 的排名，只要统计大于等于该 score 的 score 数量。</p>
<table>
<thead>
<tr>
<th style="text-align:center">Id</th>
<th style="text-align:center">score</th>
<th style="text-align:center">大于等于该 score 的 score 数量</th>
<th style="text-align:center">排名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>使用连接操作找到某个 score 对应的大于等于其值的记录：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
	<span style="color:#f92672">*</span>
<span style="color:#66d9ef">FROM</span>
    Scores S1
    <span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> Scores S2
    <span style="color:#66d9ef">ON</span> S1.score <span style="color:#f92672">&lt;=</span> S2.score
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>
    S1.score <span style="color:#66d9ef">DESC</span>, S1.Id;
</code></pre></div><table>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Scores</span><span class="w"> </span><span class="n">S1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="n">S2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">.</span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><table>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<thead>
<tr>
<th style="text-align:center">S1.Id</th>
<th style="text-align:center">S1.score</th>
<th style="text-align:center">S2.Id</th>
<th style="text-align:center">S2.score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
</tbody>
</table>
<p>可以看到每个 S1.score 都有对应好几条记录，我们再进行分组，并统计每个分组的数量作为 &lsquo;Rank&rsquo;</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    S1.score <span style="color:#e6db74">&#39;Score&#39;</span>,
    <span style="color:#66d9ef">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#e6db74">&#39;Rank&#39;</span>
<span style="color:#66d9ef">FROM</span>
    Scores S1
    <span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> Scores S2
    <span style="color:#66d9ef">ON</span> S1.score <span style="color:#f92672">&lt;=</span> S2.score
<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>
    S1.id, S1.score
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>
    S1.score <span style="color:#66d9ef">DESC</span>, S1.Id;
</code></pre></div><table>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="s1">&#39;Score&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Rank&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Scores</span><span class="w"> </span><span class="n">S1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="n">S2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">.</span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><table>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.3</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<p>上面的解法看似没问题，但是对于以下数据，它却得到了错误的结果：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Id</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<p>而我们希望的结果为：</p>
<table>
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<p>连接情况如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">S1.Id</th>
<th style="text-align:center">S1.score</th>
<th style="text-align:center">S2.Id</th>
<th style="text-align:center">S2.score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
</tbody>
</table>
<p>我们想要的结果是，把分数相同的放在同一个排名，并且相同分数只占一个位置，例如上面的分数，Id=2 和 Id=3 的记录都有相同的分数，并且最高，他们并列第一。而 Id=1 的记录应该排第二名，而不是第三名。所以在进行 COUNT 计数统计时，我们需要使用 COUNT( DISTINCT S2.score ) 从而只统计一次相同的分数。</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    S1.score <span style="color:#e6db74">&#39;Score&#39;</span>,
    <span style="color:#66d9ef">COUNT</span>( <span style="color:#66d9ef">DISTINCT</span> S2.score ) <span style="color:#e6db74">&#39;Rank&#39;</span>
<span style="color:#66d9ef">FROM</span>
    Scores S1
    <span style="color:#66d9ef">INNER</span> <span style="color:#66d9ef">JOIN</span> Scores S2
    <span style="color:#66d9ef">ON</span> S1.score <span style="color:#f92672">&lt;=</span> S2.score
<span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span>
    S1.id, S1.score
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>
    S1.score <span style="color:#66d9ef">DESC</span>;
</code></pre></div><h3 id="sql-schema-12">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> Scores;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> Scores ( Id INT, Score DECIMAL ( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> Scores ( Id, Score )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">3</span> ),
    ( <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>.<span style="color:#ae81ff">3</span> );
</code></pre></div><h2 id="180-consecutive-numbers">180. Consecutive Numbers</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="s1">&#39;Score&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">S2</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Rank&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Scores</span><span class="w"> </span><span class="n">S1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="n">S2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">S2</span><span class="p">.</span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">S1</span><span class="p">.</span><span class="n">score</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-12">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-12">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">Scores</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">Scores</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="180-consecutive-numbers">180. Consecutive Numbers<a hidden class="anchor" aria-hidden="true" href="#180-consecutive-numbers">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/consecutive-numbers/description/">https://leetcode.com/problems/consecutive-numbers/description/</a></p>
<h3 id="description-13">Description<a hidden class="anchor" aria-hidden="true" href="#description-13">#</a></h3>
<p>数字表：</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  1  |
| 3  |  1  |
| 4  |  2  |
| 5  |  1  |
| 6  |  2  |
| 7  |  2  |
+----+-----+
</code></pre></div><p>查找连续出现三次的数字。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+-----------------+
| ConsecutiveNums |
+-----------------+
| 1               |
+-----------------+
</code></pre></div><h3 id="solution-13">Solution</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span>
    <span style="color:#66d9ef">DISTINCT</span> L1.num ConsecutiveNums
<span style="color:#66d9ef">FROM</span>
    Logs L1,
    Logs L2,
    Logs L3
<span style="color:#66d9ef">WHERE</span> L1.id <span style="color:#f92672">=</span> l2.id <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">AND</span> L2.id <span style="color:#f92672">=</span> L3.id <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">AND</span> L1.num <span style="color:#f92672">=</span> L2.num
    <span style="color:#66d9ef">AND</span> l2.num <span style="color:#f92672">=</span> l3.num;
</code></pre></div><h3 id="sql-schema-13">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> LOGS;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> LOGS ( Id INT, Num INT );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> LOGS ( Id, Num )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span> ),
    ( <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span> ),
    ( <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span> );
</code></pre></div><h2 id="626-exchange-seats">626. Exchange Seats</h2>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+----+-----+
</span></span><span class="line"><span class="cl">| Id | Num |
</span></span><span class="line"><span class="cl">+----+-----+
</span></span><span class="line"><span class="cl">| 1  |  1  |
</span></span><span class="line"><span class="cl">| 2  |  1  |
</span></span><span class="line"><span class="cl">| 3  |  1  |
</span></span><span class="line"><span class="cl">| 4  |  2  |
</span></span><span class="line"><span class="cl">| 5  |  1  |
</span></span><span class="line"><span class="cl">| 6  |  2  |
</span></span><span class="line"><span class="cl">| 7  |  2  |
</span></span><span class="line"><span class="cl">+----+-----+
</span></span></code></pre></div><p>查找连续出现三次的数字。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+-----------------+
</span></span><span class="line"><span class="cl">| ConsecutiveNums |
</span></span><span class="line"><span class="cl">+-----------------+
</span></span><span class="line"><span class="cl">| 1               |
</span></span><span class="line"><span class="cl">+-----------------+
</span></span></code></pre></div><h3 id="solution-13">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-13">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">L1</span><span class="p">.</span><span class="n">num</span><span class="w"> </span><span class="n">ConsecutiveNums</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Logs</span><span class="w"> </span><span class="n">L1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Logs</span><span class="w"> </span><span class="n">L2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Logs</span><span class="w"> </span><span class="n">L3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">L1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l2</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">L2</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L3</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">L1</span><span class="p">.</span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L2</span><span class="p">.</span><span class="n">num</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">l2</span><span class="p">.</span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l3</span><span class="p">.</span><span class="n">num</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-13">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-13">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">LOGS</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">LOGS</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">LOGS</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="626-exchange-seats">626. Exchange Seats<a hidden class="anchor" aria-hidden="true" href="#626-exchange-seats">#</a></h2>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d
<p><a href="https://leetcode.com/problems/exchange-seats/description/">https://leetcode.com/problems/exchange-seats/description/</a></p>
<h3 id="description-14">Description<a hidden class="anchor" aria-hidden="true" href="#description-14">#</a></h3>
<p>seat 表存储着座位对应的学生。</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+---------+
|    id   | student |
+---------+---------+
|    1    | Abbot   |
|    2    | Doris   |
|    3    | Emerson |
|    4    | Green   |
|    5    | Jeames  |
+---------+---------+
</code></pre></div><p>要求交换相邻座位的两个学生，如果最后一个座位是奇数，那么不交换这个座位上的学生。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">+---------+---------+
|    id   | student |
+---------+---------+
|    1    | Doris   |
|    2    | Abbot   |
|    3    | Green   |
|    4    | Emerson |
|    5    | Jeames  |
+---------+---------+
</code></pre></div><h3 id="solution-14">Solution</h3>
<p>使用多个 union。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">##</span> <span style="color:#960050;background-color:#1e0010">处理偶数</span> id<span style="color:#960050;background-color:#1e0010">，让</span> id <span style="color:#960050;background-color:#1e0010">减</span> <span style="color:#ae81ff">1</span>
<span style="color:#f92672">##</span> <span style="color:#960050;background-color:#1e0010">例如</span> <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">6</span>,... <span style="color:#960050;background-color:#1e0010">变成</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,...
<span style="color:#66d9ef">SELECT</span>
    s1.id <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AS</span> id,
    s1.student
<span style="color:#66d9ef">FROM</span>
    seat s1
<span style="color:#66d9ef">WHERE</span>
    s1.id <span style="color:#66d9ef">MOD</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">UNION</span>
<span style="color:#f92672">##</span> <span style="color:#960050;background-color:#1e0010">处理奇数</span> id<span style="color:#960050;background-color:#1e0010">，让</span> id <span style="color:#960050;background-color:#1e0010">加</span> <span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">。但是如果最大的</span> id <span style="color:#960050;background-color:#1e0010">为奇数，则不做处理</span>
<span style="color:#f92672">##</span> <span style="color:#960050;background-color:#1e0010">例如</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,... <span style="color:#960050;background-color:#1e0010">变成</span> <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">6</span>,...
<span style="color:#66d9ef">SELECT</span>
    s2.id <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AS</span> id,
    s2.student
<span style="color:#66d9ef">FROM</span>
    seat s2
<span style="color:#66d9ef">WHERE</span>
    s2.id <span style="color:#66d9ef">MOD</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">AND</span> s2.id <span style="color:#f92672">!=</span> ( <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">max</span>( s3.id ) <span style="color:#66d9ef">FROM</span> seat s3 ) <span style="color:#66d9ef">UNION</span>
<span style="color:#f92672">##</span> <span style="color:#960050;background-color:#1e0010">如果最大的</span> id <span style="color:#960050;background-color:#1e0010">为奇数，单独取出这个数</span>
<span style="color:#66d9ef">SELECT</span>
    s4.id <span style="color:#66d9ef">AS</span> id,
    s4.student
<span style="color:#66d9ef">FROM</span>
    seat s4
<span style="color:#66d9ef">WHERE</span>
    s4.id <span style="color:#66d9ef">MOD</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">AND</span> s4.id <span style="color:#f92672">=</span> ( <span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">max</span>( s5.id ) <span style="color:#66d9ef">FROM</span> seat s5 )
<span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span>
    id;
</code></pre></div><h3 id="sql-schema-14">SQL Schema</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span>
<span style="color:#66d9ef">IF</span>
    <span style="color:#66d9ef">EXISTS</span> seat;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> seat ( id INT, student VARCHAR ( <span style="color:#ae81ff">255</span> ) );
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> seat ( id, student )
<span style="color:#66d9ef">VALUES</span>
    ( <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;Abbot&#39;</span> ),
    ( <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;Doris&#39;</span> ),
    ( <span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;Emerson&#39;</span> ),
    ( <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;Green&#39;</span> ),
    ( <span style="color:#e6db74">&#39;5&#39;</span>, <span style="color:#e6db74">&#39;Jeames&#39;</span> );
</code></pre></div>
</main>
=======
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+---------+
</span></span><span class="line"><span class="cl">|    id   | student |
</span></span><span class="line"><span class="cl">+---------+---------+
</span></span><span class="line"><span class="cl">|    1    | Abbot   |
</span></span><span class="line"><span class="cl">|    2    | Doris   |
</span></span><span class="line"><span class="cl">|    3    | Emerson |
</span></span><span class="line"><span class="cl">|    4    | Green   |
</span></span><span class="line"><span class="cl">|    5    | Jeames  |
</span></span><span class="line"><span class="cl">+---------+---------+
</span></span></code></pre></div><p>要求交换相邻座位的两个学生，如果最后一个座位是奇数，那么不交换这个座位上的学生。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">+---------+---------+
</span></span><span class="line"><span class="cl">|    id   | student |
</span></span><span class="line"><span class="cl">+---------+---------+
</span></span><span class="line"><span class="cl">|    1    | Doris   |
</span></span><span class="line"><span class="cl">|    2    | Abbot   |
</span></span><span class="line"><span class="cl">|    3    | Green   |
</span></span><span class="line"><span class="cl">|    4    | Emerson |
</span></span><span class="line"><span class="cl">|    5    | Jeames  |
</span></span><span class="line"><span class="cl">+---------+---------+
</span></span></code></pre></div><h3 id="solution-14">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-14">#</a></h3>
<p>使用多个 union。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">##</span><span class="w"> </span><span class="err">处理偶数</span><span class="w"> </span><span class="n">id</span><span class="err">，让</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">减</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">##</span><span class="w"> </span><span class="err">例如</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,...</span><span class="w"> </span><span class="err">变成</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s1</span><span class="p">.</span><span class="n">student</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">seat</span><span class="w"> </span><span class="n">s1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">MOD</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">##</span><span class="w"> </span><span class="err">处理奇数</span><span class="w"> </span><span class="n">id</span><span class="err">，让</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">加</span><span class="w"> </span><span class="mi">1</span><span class="err">。但是如果最大的</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">为奇数，则不做处理</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">##</span><span class="w"> </span><span class="err">例如</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,...</span><span class="w"> </span><span class="err">变成</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s2</span><span class="p">.</span><span class="n">student</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">seat</span><span class="w"> </span><span class="n">s2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">MOD</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="w"> </span><span class="n">s3</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">seat</span><span class="w"> </span><span class="n">s3</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">##</span><span class="w"> </span><span class="err">如果最大的</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="err">为奇数，单独取出这个数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s4</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s4</span><span class="p">.</span><span class="n">student</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">seat</span><span class="w"> </span><span class="n">s4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">s4</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">MOD</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">s4</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="w"> </span><span class="n">s5</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">seat</span><span class="w"> </span><span class="n">s5</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="sql-schema-14">SQL Schema<a hidden class="anchor" aria-hidden="true" href="#sql-schema-14">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">IF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">seat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">seat</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">seat</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Abbot&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Doris&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Emerson&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Green&#39;</span><span class="w"> </span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Jeames&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div>
>>>>>>> 35a30928abf5c3213b754024efc550556652db2d

  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="/">罗泽勋</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
