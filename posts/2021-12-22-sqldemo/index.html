<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <title>SQL 练习 | Zexun Luo | 罗泽勋</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="SQL 练习 🔗 SQL 练习  595. Big Countries 627. Swap Salary 620. Not Boring Movies 596. Classes More Than 5 Students 182. Duplicate Emails 196. Delete Duplicate Emails 175. Combine Two Tables 181. Employees Earning More Than Their Managers 183. Customers Who Never Order 184. Department Highest Salary 176. Second Highest Salary 177. Nth Highest Salary 178. Rank Scores 180. Consecutive Numbers 626. Exchange Seats    595. Big Countries 🔗https://leetcode.">
<meta name="generator" content="Hugo 0.99.1" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
<link href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script>

 
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-KDTTBGMLCQ', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>首页</a>
	
	
	
	

	
		<a href="/posts">博客</a>
	
		<a href="/tags">归档</a>
	
		<a href="/todos">事项</a>
	
		<a href="/about">关于</a>
	

	
	  <a class="button" href="/index.xml">订阅</a>
	
</nav>


    <main class="main">
      



<section id="single">
    <h1 class="title">SQL 练习</h1>

    <div class="tip">
        <time datetime="2021-12-22 23:32:38 &#43;0800 CST">2021年12月22日</time>
        <span class="split">
          ·
        </span>
        <span>
          1445字
        </span>
        <span class="split">
          ·
        </span>
        <span>
          7分钟
        </span>
    </div>

    
    
    


    <div class="content">
      <h1 id="sql-练习">SQL 练习 <a href="#sql-%e7%bb%83%e4%b9%a0" class="anchor">🔗</a></h1><!-- GFM-TOC -->
<ul>
<li><a href="#sql-%e7%bb%83%e4%b9%a0">SQL 练习</a>
<ul>
<li><a href="#595-big-countries">595. Big Countries</a></li>
<li><a href="#627-swap-salary">627. Swap Salary</a></li>
<li><a href="#620-not-boring-movies">620. Not Boring Movies</a></li>
<li><a href="#596-classes-more-than-5-students">596. Classes More Than 5 Students</a></li>
<li><a href="#182-duplicate-emails">182. Duplicate Emails</a></li>
<li><a href="#196-delete-duplicate-emails">196. Delete Duplicate Emails</a></li>
<li><a href="#175-combine-two-tables">175. Combine Two Tables</a></li>
<li><a href="#181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers</a></li>
<li><a href="#183-customers-who-never-order">183. Customers Who Never Order</a></li>
<li><a href="#184-department-highest-salary">184. Department Highest Salary</a></li>
<li><a href="#176-second-highest-salary">176. Second Highest Salary</a></li>
<li><a href="#177-nth-highest-salary">177. Nth Highest Salary</a></li>
<li><a href="#178-rank-scores">178. Rank Scores</a></li>
<li><a href="#180-consecutive-numbers">180. Consecutive Numbers</a></li>
<li><a href="#626-exchange-seats">626. Exchange Seats</a></li>
</ul>
</li>
</ul>
<!-- GFM-TOC -->
<h2 id="595-big-countries">595. Big Countries <a href="#595-big-countries" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/big-countries/description/" target="_blank" rel="noopener">https://leetcode.com/problems/big-countries/description/</a></p>
<h3 id="description">Description <a href="#description" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-----------------+------------+------------+--------------+---------------+
</span></span><span style="display:flex;"><span>| name            | continent  | area       | population   | gdp           |
</span></span><span style="display:flex;"><span>+-----------------+------------+------------+--------------+---------------+
</span></span><span style="display:flex;"><span>| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |
</span></span><span style="display:flex;"><span>| Albania         | Europe     | 28748      | 2831741      | 12960000      |
</span></span><span style="display:flex;"><span>| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |
</span></span><span style="display:flex;"><span>| Andorra         | Europe     | 468        | 78115        | 3712000       |
</span></span><span style="display:flex;"><span>| Angola          | Africa     | 1246700    | 20609294     | 100990000     |
</span></span><span style="display:flex;"><span>+-----------------+------------+------------+--------------+---------------+
</span></span></code></pre></div><p>查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+--------------+-------------+--------------+
</span></span><span style="display:flex;"><span>| name         | population  | area         |
</span></span><span style="display:flex;"><span>+--------------+-------------+--------------+
</span></span><span style="display:flex;"><span>| Afghanistan  | 25500100    | 652230       |
</span></span><span style="display:flex;"><span>| Algeria      | 37100000    | 2381741      |
</span></span><span style="display:flex;"><span>+--------------+-------------+--------------+
</span></span></code></pre></div><h3 id="solution">Solution <a href="#solution" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>name,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>population,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>area<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>World<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>area<span style="color:#bbb"> </span><span style="color:#666">&gt;</span><span style="color:#bbb"> </span><span style="color:#666">3000000</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">OR</span><span style="color:#bbb"> </span>population<span style="color:#bbb"> </span><span style="color:#666">&gt;</span><span style="color:#bbb"> </span><span style="color:#666">25000000</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema">SQL Schema <a href="#sql-schema" class="anchor">🔗</a></h3><p>SQL Schema 用于在本地环境下创建表结构并导入数据，从而方便在本地环境调试。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>World;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>World<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>continent<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>area<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>population<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>gdp<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>World<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>NAME,<span style="color:#bbb"> </span>continent,<span style="color:#bbb"> </span>area,<span style="color:#bbb"> </span>population,<span style="color:#bbb"> </span>gdp<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;Afghanistan&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Asia&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;652230&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;25500100&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;203430000&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;Albania&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Europe&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;28748&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;2831741&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;129600000&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;Algeria&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Africa&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;2381741&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;37100000&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;1886810000&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;Andorra&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Europe&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;468&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;78115&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;37120000&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;Angola&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Africa&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;1246700&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;20609294&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;1009900000&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="627-swap-salary">627. Swap Salary <a href="#627-swap-salary" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/swap-salary/description/" target="_blank" rel="noopener">https://leetcode.com/problems/swap-salary/description/</a></p>
<h3 id="description-1">Description <a href="#description-1" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>| id | name | sex | salary |
</span></span><span style="display:flex;"><span>|----|------|-----|--------|
</span></span><span style="display:flex;"><span>| 1  | A    | m   | 2500   |
</span></span><span style="display:flex;"><span>| 2  | B    | f   | 1500   |
</span></span><span style="display:flex;"><span>| 3  | C    | m   | 5500   |
</span></span><span style="display:flex;"><span>| 4  | D    | f   | 500    |
</span></span></code></pre></div><p>只用一个 SQL 查询，将 sex 字段反转。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>| id | name | sex | salary |
</span></span><span style="display:flex;"><span>|----|------|-----|--------|
</span></span><span style="display:flex;"><span>| 1  | A    | f   | 2500   |
</span></span><span style="display:flex;"><span>| 2  | B    | m   | 1500   |
</span></span><span style="display:flex;"><span>| 3  | C    | f   | 5500   |
</span></span><span style="display:flex;"><span>| 4  | D    | m   | 500    |
</span></span></code></pre></div><h3 id="solution-1">Solution <a href="#solution-1" class="anchor">🔗</a></h3><p>两个相等的数异或的结果为 0，而 0 与任何一个数异或的结果为这个数。</p>
<p>sex  字段只有两个取值：&lsquo;f&rsquo; 和 &rsquo;m&rsquo;，并且有以下规律：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&#39;f&#39; ^ (&#39;m&#39; ^ &#39;f&#39;) = &#39;m&#39; ^ (&#39;f&#39; ^ &#39;f&#39;) = &#39;m&#39;
</span></span><span style="display:flex;"><span>&#39;m&#39; ^ (&#39;m&#39; ^ &#39;f&#39;) = &#39;f&#39; ^ (&#39;m&#39; ^ &#39;m&#39;) = &#39;f&#39;
</span></span></code></pre></div><p>因此将 sex 字段和 &rsquo;m&rsquo; ^ &lsquo;f&rsquo; 进行异或操作，最后就能反转 sex 字段。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">UPDATE</span><span style="color:#bbb"> </span>salary<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">SET</span><span style="color:#bbb"> </span>sex<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f">CHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>ASCII(sex)<span style="color:#bbb"> </span><span style="color:#666">^</span><span style="color:#bbb"> </span>ASCII(<span style="color:#bbb"> </span><span style="color:#b44">&#39;m&#39;</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#666">^</span><span style="color:#bbb"> </span>ASCII(<span style="color:#bbb"> </span><span style="color:#b44">&#39;f&#39;</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-1">SQL Schema <a href="#sql-schema-1" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>salary;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>salary<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">100</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>sex<span style="color:#bbb"> </span><span style="color:#a2f">CHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>salary<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>salary<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id,<span style="color:#bbb"> </span>NAME,<span style="color:#bbb"> </span>sex,<span style="color:#bbb"> </span>salary<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;1&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;A&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;m&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;2500&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;2&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;B&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;f&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;1500&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;3&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;C&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;m&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;5500&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;4&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;D&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;f&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;500&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="620-not-boring-movies">620. Not Boring Movies <a href="#620-not-boring-movies" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/not-boring-movies/description/" target="_blank" rel="noopener">https://leetcode.com/problems/not-boring-movies/description/</a></p>
<h3 id="description-2">Description <a href="#description-2" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span><span style="display:flex;"><span>|   id    | movie     |  description |  rating   |
</span></span><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span><span style="display:flex;"><span>|   1     | War       |   great 3D   |   8.9     |
</span></span><span style="display:flex;"><span>|   2     | Science   |   fiction    |   8.5     |
</span></span><span style="display:flex;"><span>|   3     | irish     |   boring     |   6.2     |
</span></span><span style="display:flex;"><span>|   4     | Ice song  |   Fantacy    |   8.6     |
</span></span><span style="display:flex;"><span>|   5     | House card|   Interesting|   9.1     |
</span></span><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span></code></pre></div><p>查找 id 为奇数，并且 description 不是 boring 的电影，按 rating 降序。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span><span style="display:flex;"><span>|   id    | movie     |  description |  rating   |
</span></span><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span><span style="display:flex;"><span>|   5     | House card|   Interesting|   9.1     |
</span></span><span style="display:flex;"><span>|   1     | War       |   great 3D   |   8.9     |
</span></span><span style="display:flex;"><span>+---------+-----------+--------------+-----------+
</span></span></code></pre></div><h3 id="solution-2">Solution <a href="#solution-2" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#666">*</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>cinema<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#666">%</span><span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>description<span style="color:#bbb"> </span><span style="color:#666">!=</span><span style="color:#bbb"> </span><span style="color:#b44">&#39;boring&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>rating<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-2">SQL Schema <a href="#sql-schema-2" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>cinema;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>cinema<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>movie<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>description<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>rating<span style="color:#bbb"> </span><span style="color:#a2f">FLOAT</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>cinema<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id,<span style="color:#bbb"> </span>movie,<span style="color:#bbb"> </span>description,<span style="color:#bbb"> </span>rating<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;War&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;great 3D&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">8</span>.<span style="color:#666">9</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Science&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;fiction&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">8</span>.<span style="color:#666">5</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;irish&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;boring&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">6</span>.<span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Ice song&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Fantacy&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">8</span>.<span style="color:#666">6</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">5</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;House card&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Interesting&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">9</span>.<span style="color:#666">1</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="596-classes-more-than-5-students">596. Classes More Than 5 Students <a href="#596-classes-more-than-5-students" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/classes-more-than-5-students/description/" target="_blank" rel="noopener">https://leetcode.com/problems/classes-more-than-5-students/description/</a></p>
<h3 id="description-3">Description <a href="#description-3" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+------------+
</span></span><span style="display:flex;"><span>| student | class      |
</span></span><span style="display:flex;"><span>+---------+------------+
</span></span><span style="display:flex;"><span>| A       | Math       |
</span></span><span style="display:flex;"><span>| B       | English    |
</span></span><span style="display:flex;"><span>| C       | Math       |
</span></span><span style="display:flex;"><span>| D       | Biology    |
</span></span><span style="display:flex;"><span>| E       | Math       |
</span></span><span style="display:flex;"><span>| F       | Computer   |
</span></span><span style="display:flex;"><span>| G       | Math       |
</span></span><span style="display:flex;"><span>| H       | Math       |
</span></span><span style="display:flex;"><span>| I       | Math       |
</span></span><span style="display:flex;"><span>+---------+------------+
</span></span></code></pre></div><p>查找有五名及以上 student 的 class。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+
</span></span><span style="display:flex;"><span>| class   |
</span></span><span style="display:flex;"><span>+---------+
</span></span><span style="display:flex;"><span>| Math    |
</span></span><span style="display:flex;"><span>+---------+
</span></span></code></pre></div><h3 id="solution-3">Solution <a href="#solution-3" class="anchor">🔗</a></h3><p>对 class 列进行分组之后，再使用 count 汇总函数统计每个分组的记录个数，之后使用 HAVING 进行筛选。HAVING  针对分组进行筛选，而 WHERE 针对每个记录（行）进行筛选。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">class</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>courses<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">class</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">HAVING</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">count</span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DISTINCT</span><span style="color:#bbb"> </span>student<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#666">&gt;=</span><span style="color:#bbb"> </span><span style="color:#666">5</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-3">SQL Schema <a href="#sql-schema-3" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>courses;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>courses<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>student<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">class</span><span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>courses<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>student,<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">class</span><span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;A&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;B&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;English&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;C&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;D&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Biology&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;E&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;F&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Computer&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;G&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;H&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;I&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Math&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="182-duplicate-emails">182. Duplicate Emails <a href="#182-duplicate-emails" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/duplicate-emails/description/" target="_blank" rel="noopener">https://leetcode.com/problems/duplicate-emails/description/</a></p>
<h3 id="description-4">Description <a href="#description-4" class="anchor">🔗</a></h3><p>邮件地址表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+---------+
</span></span><span style="display:flex;"><span>| Id | Email   |
</span></span><span style="display:flex;"><span>+----+---------+
</span></span><span style="display:flex;"><span>| 1  | a@b.com |
</span></span><span style="display:flex;"><span>| 2  | c@d.com |
</span></span><span style="display:flex;"><span>| 3  | a@b.com |
</span></span><span style="display:flex;"><span>+----+---------+
</span></span></code></pre></div><p>查找重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+
</span></span><span style="display:flex;"><span>| Email   |
</span></span><span style="display:flex;"><span>+---------+
</span></span><span style="display:flex;"><span>| a@b.com |
</span></span><span style="display:flex;"><span>+---------+
</span></span></code></pre></div><h3 id="solution-4">Solution <a href="#solution-4" class="anchor">🔗</a></h3><p>对 Email 进行分组，如果并使用 COUNT 进行计数统计，结果大于等于 2 的表示 Email  重复。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Email<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Email<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">HAVING</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">COUNT</span>(<span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#666">&gt;=</span><span style="color:#bbb"> </span><span style="color:#666">2</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-4">SQL Schema <a href="#sql-schema-4" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Person;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Person<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>Email<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Person<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>Email<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;a@b.com&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;c@d.com&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;a@b.com&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="196-delete-duplicate-emails">196. Delete Duplicate Emails <a href="#196-delete-duplicate-emails" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/delete-duplicate-emails/description/" target="_blank" rel="noopener">https://leetcode.com/problems/delete-duplicate-emails/description/</a></p>
<h3 id="description-5">Description <a href="#description-5" class="anchor">🔗</a></h3><p>邮件地址表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+---------+
</span></span><span style="display:flex;"><span>| Id | Email   |
</span></span><span style="display:flex;"><span>+----+---------+
</span></span><span style="display:flex;"><span>| 1  | john@example.com |
</span></span><span style="display:flex;"><span>| 2  | bob@example.com |
</span></span><span style="display:flex;"><span>| 3  | john@example.com |
</span></span><span style="display:flex;"><span>+----+---------+
</span></span></code></pre></div><p>删除重复的邮件地址：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+------------------+
</span></span><span style="display:flex;"><span>| Id | Email            |
</span></span><span style="display:flex;"><span>+----+------------------+
</span></span><span style="display:flex;"><span>| 1  | john@example.com |
</span></span><span style="display:flex;"><span>| 2  | bob@example.com  |
</span></span><span style="display:flex;"><span>+----+------------------+
</span></span></code></pre></div><h3 id="solution-5">Solution <a href="#solution-5" class="anchor">🔗</a></h3><p>只保留相同 Email 中 Id 最小的那一个，然后删除其它的。</p>
<p>连接查询：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DELETE</span><span style="color:#bbb"> </span>p1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb"> </span>p1,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb"> </span>p2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>p1.Email<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>p2.Email<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>p1.Id<span style="color:#bbb"> </span><span style="color:#666">&gt;</span><span style="color:#bbb"> </span>p2.Id<span style="color:#bbb">
</span></span></span></code></pre></div><p>子查询：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DELETE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NOT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IN</span><span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">min</span>(<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Person<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb"> </span>email<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>m<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><p>应该注意的是上述解法额外嵌套了一个 SELECT 语句，如果不这么做，会出现错误：You can&rsquo;t specify target table &lsquo;Person&rsquo; for update in FROM clause。以下演示了这种错误解法。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DELETE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NOT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IN</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">min</span>(<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Person<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb"> </span>email<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><p>参考：<a href="https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause" target="_blank" rel="noopener">pMySQL Error 1093 - Can&rsquo;t specify target table for update in FROM clause</a></p>
<h3 id="sql-schema-5">SQL Schema <a href="#sql-schema-5" class="anchor">🔗</a></h3><p>与 182 相同。</p>
<h2 id="175-combine-two-tables">175. Combine Two Tables <a href="#175-combine-two-tables" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/combine-two-tables/description/" target="_blank" rel="noopener">https://leetcode.com/problems/combine-two-tables/description/</a></p>
<h3 id="description-6">Description <a href="#description-6" class="anchor">🔗</a></h3><p>Person 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>| Column Name | Type    |
</span></span><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>| PersonId    | int     |
</span></span><span style="display:flex;"><span>| FirstName   | varchar |
</span></span><span style="display:flex;"><span>| LastName    | varchar |
</span></span><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>PersonId is the primary key column for this table.
</span></span></code></pre></div><p>Address 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>| Column Name | Type    |
</span></span><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>| AddressId   | int     |
</span></span><span style="display:flex;"><span>| PersonId    | int     |
</span></span><span style="display:flex;"><span>| City        | varchar |
</span></span><span style="display:flex;"><span>| State       | varchar |
</span></span><span style="display:flex;"><span>+-------------+---------+
</span></span><span style="display:flex;"><span>AddressId is the primary key column for this table.
</span></span></code></pre></div><p>查找 FirstName, LastName, City, State 数据，而不管一个用户有没有填地址信息。</p>
<h3 id="solution-6">Solution <a href="#solution-6" class="anchor">🔗</a></h3><p>涉及到 Person 和 Address 两个表，在对这两个表执行连接操作时，因为要保留 Person 表中的信息，即使在 Address 表中没有关联的信息也要保留。此时可以用左外连接，将 Person 表放在 LEFT JOIN 的左边。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>FirstName,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>LastName,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>City,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">State</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Person<span style="color:#bbb"> </span>P<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">LEFT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Address<span style="color:#bbb"> </span>A<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span>P.PersonId<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>A.PersonId;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-6">SQL Schema <a href="#sql-schema-6" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Person;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Person<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>PersonId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>FirstName<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>LastName<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Address;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Address<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>AddressId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>PersonId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>City<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">State</span><span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Person<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>PersonId,<span style="color:#bbb"> </span>LastName,<span style="color:#bbb"> </span>FirstName<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Wang&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Allen&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Address<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>AddressId,<span style="color:#bbb"> </span>PersonId,<span style="color:#bbb"> </span>City,<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">State</span><span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;New York City&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;New York&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="181-employees-earning-more-than-their-managers">181. Employees Earning More Than Their Managers <a href="#181-employees-earning-more-than-their-managers" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/description/" target="_blank" rel="noopener">https://leetcode.com/problems/employees-earning-more-than-their-managers/description/</a></p>
<h3 id="description-7">Description <a href="#description-7" class="anchor">🔗</a></h3><p>Employee 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+-------+--------+-----------+
</span></span><span style="display:flex;"><span>| Id | Name  | Salary | ManagerId |
</span></span><span style="display:flex;"><span>+----+-------+--------+-----------+
</span></span><span style="display:flex;"><span>| 1  | Joe   | 70000  | 3         |
</span></span><span style="display:flex;"><span>| 2  | Henry | 80000  | 4         |
</span></span><span style="display:flex;"><span>| 3  | Sam   | 60000  | NULL      |
</span></span><span style="display:flex;"><span>| 4  | Max   | 90000  | NULL      |
</span></span><span style="display:flex;"><span>+----+-------+--------+-----------+
</span></span></code></pre></div><p>查找薪资大于其经理薪资的员工信息。</p>
<h3 id="solution-7">Solution <a href="#solution-7" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>E1.NAME<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Employee<span style="color:#bbb"> </span>E1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">INNER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>E2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span>E1.ManagerId<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>E2.Id<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>E1.Salary<span style="color:#bbb"> </span><span style="color:#666">&gt;</span><span style="color:#bbb"> </span>E2.Salary;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-7">SQL Schema <a href="#sql-schema-7" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Employee;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>ManagerId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>NAME,<span style="color:#bbb"> </span>Salary,<span style="color:#bbb"> </span>ManagerId<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Joe&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">70000</span>,<span style="color:#bbb"> </span><span style="color:#666">3</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Henry&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">80000</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Sam&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">60000</span>,<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NULL</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Max&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">90000</span>,<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NULL</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="183-customers-who-never-order">183. Customers Who Never Order <a href="#183-customers-who-never-order" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/customers-who-never-order/description/" target="_blank" rel="noopener">https://leetcode.com/problems/customers-who-never-order/description/</a></p>
<h3 id="description-8">Description <a href="#description-8" class="anchor">🔗</a></h3><p>Customers 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+-------+
</span></span><span style="display:flex;"><span>| Id | Name  |
</span></span><span style="display:flex;"><span>+----+-------+
</span></span><span style="display:flex;"><span>| 1  | Joe   |
</span></span><span style="display:flex;"><span>| 2  | Henry |
</span></span><span style="display:flex;"><span>| 3  | Sam   |
</span></span><span style="display:flex;"><span>| 4  | Max   |
</span></span><span style="display:flex;"><span>+----+-------+
</span></span></code></pre></div><p>Orders 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+------------+
</span></span><span style="display:flex;"><span>| Id | CustomerId |
</span></span><span style="display:flex;"><span>+----+------------+
</span></span><span style="display:flex;"><span>| 1  | 3          |
</span></span><span style="display:flex;"><span>| 2  | 1          |
</span></span><span style="display:flex;"><span>+----+------------+
</span></span></code></pre></div><p>查找没有订单的顾客信息：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-----------+
</span></span><span style="display:flex;"><span>| Customers |
</span></span><span style="display:flex;"><span>+-----------+
</span></span><span style="display:flex;"><span>| Henry     |
</span></span><span style="display:flex;"><span>| Max       |
</span></span><span style="display:flex;"><span>+-----------+
</span></span></code></pre></div><h3 id="solution-8">Solution <a href="#solution-8" class="anchor">🔗</a></h3><p>左外链接</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">C</span>.Name<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>Customers<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Customers<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">C</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">LEFT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Orders<span style="color:#bbb"> </span>O<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">C</span>.Id<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>O.CustomerId<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>O.CustomerId<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IS</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NULL</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><p>子查询</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Name<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>Customers<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Customers<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">NOT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IN</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>CustomerId<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Orders<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-8">SQL Schema <a href="#sql-schema-8" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Customers;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Customers<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Orders;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Orders<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>CustomerId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Customers<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Joe&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Henry&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Sam&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Max&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Orders<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>CustomerId<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">3</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="184-department-highest-salary">184. Department Highest Salary <a href="#184-department-highest-salary" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/department-highest-salary/description/" target="_blank" rel="noopener">https://leetcode.com/problems/department-highest-salary/description/</a></p>
<h3 id="description-9">Description <a href="#description-9" class="anchor">🔗</a></h3><p>Employee 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+-------+--------+--------------+
</span></span><span style="display:flex;"><span>| Id | Name  | Salary | DepartmentId |
</span></span><span style="display:flex;"><span>+----+-------+--------+--------------+
</span></span><span style="display:flex;"><span>| 1  | Joe   | 70000  | 1            |
</span></span><span style="display:flex;"><span>| 2  | Henry | 80000  | 2            |
</span></span><span style="display:flex;"><span>| 3  | Sam   | 60000  | 2            |
</span></span><span style="display:flex;"><span>| 4  | Max   | 90000  | 1            |
</span></span><span style="display:flex;"><span>+----+-------+--------+--------------+
</span></span></code></pre></div><p>Department 表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+----------+
</span></span><span style="display:flex;"><span>| Id | Name     |
</span></span><span style="display:flex;"><span>+----+----------+
</span></span><span style="display:flex;"><span>| 1  | IT       |
</span></span><span style="display:flex;"><span>| 2  | Sales    |
</span></span><span style="display:flex;"><span>+----+----------+
</span></span></code></pre></div><p>查找一个 Department 中收入最高者的信息：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+------------+----------+--------+
</span></span><span style="display:flex;"><span>| Department | Employee | Salary |
</span></span><span style="display:flex;"><span>+------------+----------+--------+
</span></span><span style="display:flex;"><span>| IT         | Max      | 90000  |
</span></span><span style="display:flex;"><span>| Sales      | Henry    | 80000  |
</span></span><span style="display:flex;"><span>+------------+----------+--------+
</span></span></code></pre></div><h3 id="solution-9">Solution <a href="#solution-9" class="anchor">🔗</a></h3><p>创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。</p>
<p>之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>D.NAME<span style="color:#bbb"> </span>Department,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>E.NAME<span style="color:#bbb"> </span>Employee,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>E.Salary<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Employee<span style="color:#bbb"> </span>E,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Department<span style="color:#bbb"> </span>D,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>DepartmentId,<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">MAX</span>(<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb"> </span>DepartmentId<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>M<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>E.DepartmentId<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>D.Id<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>E.DepartmentId<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>M.DepartmentId<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>E.Salary<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>M.Salary;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-9">SQL Schema <a href="#sql-schema-9" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Employee;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>),<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>DepartmentId<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Department;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Department<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>NAME,<span style="color:#bbb"> </span>Salary,<span style="color:#bbb"> </span>DepartmentId<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Joe&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">70000</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Henry&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">80000</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Sam&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">60000</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Max&#39;</span>,<span style="color:#bbb"> </span><span style="color:#666">90000</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Department<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>NAME<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;IT&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Sales&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="176-second-highest-salary">176. Second Highest Salary <a href="#176-second-highest-salary" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/second-highest-salary/description/" target="_blank" rel="noopener">https://leetcode.com/problems/second-highest-salary/description/</a></p>
<h3 id="description-10">Description <a href="#description-10" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+--------+
</span></span><span style="display:flex;"><span>| Id | Salary |
</span></span><span style="display:flex;"><span>+----+--------+
</span></span><span style="display:flex;"><span>| 1  | 100    |
</span></span><span style="display:flex;"><span>| 2  | 200    |
</span></span><span style="display:flex;"><span>| 3  | 300    |
</span></span><span style="display:flex;"><span>+----+--------+
</span></span></code></pre></div><p>查找工资第二高的员工。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------------------+
</span></span><span style="display:flex;"><span>| SecondHighestSalary |
</span></span><span style="display:flex;"><span>+---------------------+
</span></span><span style="display:flex;"><span>| 200                 |
</span></span><span style="display:flex;"><span>+---------------------+
</span></span></code></pre></div><p>没有找到返回 null 而不是不返回数据。</p>
<h3 id="solution-10">Solution <a href="#solution-10" class="anchor">🔗</a></h3><p>为了在没有查找到数据时返回 null，需要在查询结果外面再套一层 SELECT。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DISTINCT</span><span style="color:#bbb"> </span>Salary<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">LIMIT</span><span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>SecondHighestSalary;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-10">SQL Schema <a href="#sql-schema-10" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Employee;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">100</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#666">200</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#666">300</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="177-nth-highest-salary">177. Nth Highest Salary <a href="#177-nth-highest-salary" class="anchor">🔗</a></h2><h3 id="description-11">Description <a href="#description-11" class="anchor">🔗</a></h3><p>查找工资第 N 高的员工。</p>
<h3 id="solution-11">Solution <a href="#solution-11" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">FUNCTION</span><span style="color:#bbb"> </span>getNthHighestSalary<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>N<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">RETURNS</span><span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BEGIN</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">SET</span><span style="color:#bbb"> </span>N<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>N<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span><span style="color:#666">1</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">RETURN</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DISTINCT</span><span style="color:#bbb"> </span>Salary<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>Employee<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb"> </span>Salary<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">LIMIT</span><span style="color:#bbb"> </span>N,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>)<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">END</span><span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-11">SQL Schema <a href="#sql-schema-11" class="anchor">🔗</a></h3><p>同 176。</p>
<h2 id="178-rank-scores">178. Rank Scores <a href="#178-rank-scores" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/rank-scores/description/" target="_blank" rel="noopener">https://leetcode.com/problems/rank-scores/description/</a></p>
<h3 id="description-12">Description <a href="#description-12" class="anchor">🔗</a></h3><p>得分表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+-------+
</span></span><span style="display:flex;"><span>| Id | Score |
</span></span><span style="display:flex;"><span>+----+-------+
</span></span><span style="display:flex;"><span>| 1  | 3.50  |
</span></span><span style="display:flex;"><span>| 2  | 3.65  |
</span></span><span style="display:flex;"><span>| 3  | 4.00  |
</span></span><span style="display:flex;"><span>| 4  | 3.85  |
</span></span><span style="display:flex;"><span>| 5  | 4.00  |
</span></span><span style="display:flex;"><span>| 6  | 3.65  |
</span></span><span style="display:flex;"><span>+----+-------+
</span></span></code></pre></div><p>将得分排序，并统计排名。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-------+------+
</span></span><span style="display:flex;"><span>| Score | Rank |
</span></span><span style="display:flex;"><span>+-------+------+
</span></span><span style="display:flex;"><span>| 4.00  | 1    |
</span></span><span style="display:flex;"><span>| 4.00  | 1    |
</span></span><span style="display:flex;"><span>| 3.85  | 2    |
</span></span><span style="display:flex;"><span>| 3.65  | 3    |
</span></span><span style="display:flex;"><span>| 3.65  | 3    |
</span></span><span style="display:flex;"><span>| 3.50  | 4    |
</span></span><span style="display:flex;"><span>+-------+------+
</span></span></code></pre></div><h3 id="solution-12">Solution <a href="#solution-12" class="anchor">🔗</a></h3><p>要统计某个 score 的排名，只要统计大于等于该 score 的 score 数量。</p>
<table>
<thead>
<tr>
<th style="text-align:center">Id</th>
<th style="text-align:center">score</th>
<th style="text-align:center">大于等于该 score 的 score 数量</th>
<th style="text-align:center">排名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>使用连接操作找到某个 score 对应的大于等于其值的记录：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#666">*</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Scores<span style="color:#bbb"> </span>S1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">INNER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Scores<span style="color:#bbb"> </span>S2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span>S1.score<span style="color:#bbb"> </span><span style="color:#666">&lt;=</span><span style="color:#bbb"> </span>S2.score<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.score<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span>,<span style="color:#bbb"> </span>S1.Id;<span style="color:#bbb">
</span></span></span></code></pre></div><table>
<thead>
<tr>
<th style="text-align:center">S1.Id</th>
<th style="text-align:center">S1.score</th>
<th style="text-align:center">S2.Id</th>
<th style="text-align:center">S2.score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.3</td>
</tr>
</tbody>
</table>
<p>可以看到每个 S1.score 都有对应好几条记录，我们再进行分组，并统计每个分组的数量作为 &lsquo;Rank&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.score<span style="color:#bbb"> </span><span style="color:#b44">&#39;Score&#39;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">COUNT</span>(<span style="color:#666">*</span>)<span style="color:#bbb"> </span><span style="color:#b44">&#39;Rank&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Scores<span style="color:#bbb"> </span>S1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">INNER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Scores<span style="color:#bbb"> </span>S2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span>S1.score<span style="color:#bbb"> </span><span style="color:#666">&lt;=</span><span style="color:#bbb"> </span>S2.score<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.id,<span style="color:#bbb"> </span>S1.score<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.score<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span>,<span style="color:#bbb"> </span>S1.Id;<span style="color:#bbb">
</span></span></span></code></pre></div><table>
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.3</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<p>上面的解法看似没问题，但是对于以下数据，它却得到了错误的结果：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Id</th>
<th style="text-align:center">score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<p>而我们希望的结果为：</p>
<table>
<thead>
<tr>
<th style="text-align:center">score</th>
<th style="text-align:center">Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.2</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<p>连接情况如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">S1.Id</th>
<th style="text-align:center">S1.score</th>
<th style="text-align:center">S2.Id</th>
<th style="text-align:center">S2.score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.1</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">4.1</td>
</tr>
</tbody>
</table>
<p>我们想要的结果是，把分数相同的放在同一个排名，并且相同分数只占一个位置，例如上面的分数，Id=2 和 Id=3 的记录都有相同的分数，并且最高，他们并列第一。而 Id=1 的记录应该排第二名，而不是第三名。所以在进行 COUNT 计数统计时，我们需要使用 COUNT( DISTINCT S2.score ) 从而只统计一次相同的分数。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.score<span style="color:#bbb"> </span><span style="color:#b44">&#39;Score&#39;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">COUNT</span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DISTINCT</span><span style="color:#bbb"> </span>S2.score<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#b44">&#39;Rank&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Scores<span style="color:#bbb"> </span>S1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">INNER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>Scores<span style="color:#bbb"> </span>S2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">ON</span><span style="color:#bbb"> </span>S1.score<span style="color:#bbb"> </span><span style="color:#666">&lt;=</span><span style="color:#bbb"> </span>S2.score<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">GROUP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.id,<span style="color:#bbb"> </span>S1.score<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>S1.score<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">DESC</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-12">SQL Schema <a href="#sql-schema-12" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>Scores;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>Scores<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>Score<span style="color:#bbb"> </span><span style="color:#a2f">DECIMAL</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>Scores<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>Score<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">5</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">3</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">6</span>,<span style="color:#bbb"> </span><span style="color:#666">4</span>.<span style="color:#666">3</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="180-consecutive-numbers">180. Consecutive Numbers <a href="#180-consecutive-numbers" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/consecutive-numbers/description/" target="_blank" rel="noopener">https://leetcode.com/problems/consecutive-numbers/description/</a></p>
<h3 id="description-13">Description <a href="#description-13" class="anchor">🔗</a></h3><p>数字表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+----+-----+
</span></span><span style="display:flex;"><span>| Id | Num |
</span></span><span style="display:flex;"><span>+----+-----+
</span></span><span style="display:flex;"><span>| 1  |  1  |
</span></span><span style="display:flex;"><span>| 2  |  1  |
</span></span><span style="display:flex;"><span>| 3  |  1  |
</span></span><span style="display:flex;"><span>| 4  |  2  |
</span></span><span style="display:flex;"><span>| 5  |  1  |
</span></span><span style="display:flex;"><span>| 6  |  2  |
</span></span><span style="display:flex;"><span>| 7  |  2  |
</span></span><span style="display:flex;"><span>+----+-----+
</span></span></code></pre></div><p>查找连续出现三次的数字。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+-----------------+
</span></span><span style="display:flex;"><span>| ConsecutiveNums |
</span></span><span style="display:flex;"><span>+-----------------+
</span></span><span style="display:flex;"><span>| 1               |
</span></span><span style="display:flex;"><span>+-----------------+
</span></span></code></pre></div><h3 id="solution-13">Solution <a href="#solution-13" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">DISTINCT</span><span style="color:#bbb"> </span>L1.num<span style="color:#bbb"> </span>ConsecutiveNums<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Logs<span style="color:#bbb"> </span>L1,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Logs<span style="color:#bbb"> </span>L2,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Logs<span style="color:#bbb"> </span>L3<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>L1.id<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>l2.id<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>L2.id<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>L3.id<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>L1.num<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>L2.num<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>l2.num<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>l3.num;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-13">SQL Schema <a href="#sql-schema-13" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>LOGS;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>LOGS<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>Num<span style="color:#bbb"> </span><span style="color:#a2f">INT</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>LOGS<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>Id,<span style="color:#bbb"> </span>Num<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">3</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">4</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">5</span>,<span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">6</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#666">7</span>,<span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="626-exchange-seats">626. Exchange Seats <a href="#626-exchange-seats" class="anchor">🔗</a></h2><p><a href="https://leetcode.com/problems/exchange-seats/description/" target="_blank" rel="noopener">https://leetcode.com/problems/exchange-seats/description/</a></p>
<h3 id="description-14">Description <a href="#description-14" class="anchor">🔗</a></h3><p>seat 表存储着座位对应的学生。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+---------+
</span></span><span style="display:flex;"><span>|    id   | student |
</span></span><span style="display:flex;"><span>+---------+---------+
</span></span><span style="display:flex;"><span>|    1    | Abbot   |
</span></span><span style="display:flex;"><span>|    2    | Doris   |
</span></span><span style="display:flex;"><span>|    3    | Emerson |
</span></span><span style="display:flex;"><span>|    4    | Green   |
</span></span><span style="display:flex;"><span>|    5    | Jeames  |
</span></span><span style="display:flex;"><span>+---------+---------+
</span></span></code></pre></div><p>要求交换相邻座位的两个学生，如果最后一个座位是奇数，那么不交换这个座位上的学生。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>+---------+---------+
</span></span><span style="display:flex;"><span>|    id   | student |
</span></span><span style="display:flex;"><span>+---------+---------+
</span></span><span style="display:flex;"><span>|    1    | Doris   |
</span></span><span style="display:flex;"><span>|    2    | Abbot   |
</span></span><span style="display:flex;"><span>|    3    | Green   |
</span></span><span style="display:flex;"><span>|    4    | Emerson |
</span></span><span style="display:flex;"><span>|    5    | Jeames  |
</span></span><span style="display:flex;"><span>+---------+---------+
</span></span></code></pre></div><h3 id="solution-14">Solution <a href="#solution-14" class="anchor">🔗</a></h3><p>使用多个 union。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#666">##</span><span style="color:#bbb"> </span><span style="">处理偶数</span><span style="color:#bbb"> </span>id<span style="">，让</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="">减</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">##</span><span style="color:#bbb"> </span><span style="">例如</span><span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#666">4</span>,<span style="color:#666">6</span>,...<span style="color:#bbb"> </span><span style="">变成</span><span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#666">3</span>,<span style="color:#666">5</span>,...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s1.id<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>id,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s1.student<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>seat<span style="color:#bbb"> </span>s1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s1.id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">MOD</span><span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#666">0</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">UNION</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">##</span><span style="color:#bbb"> </span><span style="">处理奇数</span><span style="color:#bbb"> </span>id<span style="">，让</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="">加</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="">。但是如果最大的</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="">为奇数，则不做处理</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">##</span><span style="color:#bbb"> </span><span style="">例如</span><span style="color:#bbb"> </span><span style="color:#666">1</span>,<span style="color:#666">3</span>,<span style="color:#666">5</span>,...<span style="color:#bbb"> </span><span style="">变成</span><span style="color:#bbb"> </span><span style="color:#666">2</span>,<span style="color:#666">4</span>,<span style="color:#666">6</span>,...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s2.id<span style="color:#bbb"> </span><span style="color:#666">+</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>id,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s2.student<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>seat<span style="color:#bbb"> </span>s2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s2.id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">MOD</span><span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>s2.id<span style="color:#bbb"> </span><span style="color:#666">!=</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">max</span>(<span style="color:#bbb"> </span>s3.id<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>seat<span style="color:#bbb"> </span>s3<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">UNION</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#666">##</span><span style="color:#bbb"> </span><span style="">如果最大的</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="">为奇数，单独取出这个数</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s4.id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">AS</span><span style="color:#bbb"> </span>id,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s4.student<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>seat<span style="color:#bbb"> </span>s4<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>s4.id<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">MOD</span><span style="color:#bbb"> </span><span style="color:#666">2</span><span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#666">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">AND</span><span style="color:#bbb"> </span>s4.id<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">max</span>(<span style="color:#bbb"> </span>s5.id<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">FROM</span><span style="color:#bbb"> </span>seat<span style="color:#bbb"> </span>s5<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="sql-schema-14">SQL Schema <a href="#sql-schema-14" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">IF</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span>seat;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">TABLE</span><span style="color:#bbb"> </span>seat<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="color:#a2f">INT</span>,<span style="color:#bbb"> </span>student<span style="color:#bbb"> </span><span style="color:#a2f">VARCHAR</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#666">255</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">INTO</span><span style="color:#bbb"> </span>seat<span style="color:#bbb"> </span>(<span style="color:#bbb"> </span>id,<span style="color:#bbb"> </span>student<span style="color:#bbb"> </span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">VALUES</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;1&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Abbot&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;2&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Doris&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;3&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Emerson&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;4&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Green&#39;</span><span style="color:#bbb"> </span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>(<span style="color:#bbb"> </span><span style="color:#b44">&#39;5&#39;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#39;Jeames&#39;</span><span style="color:#bbb"> </span>);<span style="color:#bbb">
</span></span></span></code></pre></div>
    </div>

    
        <div class="tags">
            
                <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93">数据库</a>
            
        </div>
    
    
    


<script src="https://utteranc.es/client.js"
repo=""
issue-term=""
theme=""
crossorigin="anonymous"
async>
</script>





</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
       © Copyright 
       2022 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       罗泽勋
    
    </div>

    
</footer>



  </body>
</html>
